<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>ECharts</title>

    <script src="./echarts.js"></script>
    <script src='./ecStataaa.js'></script>
    <!--<script src='./FileSaver.js'></script>-->

    <style>
        canvas { border: 1px solid black; }



        .button_color {
        //background-color: #4CAF50; /* Green */
            border: none;
            color: white;
            padding: 15px 32px;
            text-align: center;
            text-decoration: none;
            /*display: inline-block;*/
            font-size: 16px;
            cursor: pointer;
            /*float: left;*/
        }
        .button0 {
            background-color: #000000;
        }
        .button1 {
            background-color: #4CAF50;
        }
        .button2 {
            background-color: #008CBA;
        }
        .button3 {
            background-color: #b80af4;
        }
        .button4 {
            background-color: #ffffff;
        }
        .button0:hover {
            background-color: #808080;
        }
        .button1:hover {
            background-color: #808080;
        }
        .button2:hover {
            background-color: #808080;
        }
        .button3:hover {
            background-color: #808080;
        }


        .button4{color: black;}
        .button4:hover {
            background-color: #808080;
        }


    </style>



</head>
<body onload="initscatter()">
<!-- 为ECharts准备一个具备大小（宽高）的Dom -->
<div>
    <!--//id=1 2 3 直接用户数组小标 不用判断-->
    <button id="0" class="button_color button0" onclick="setcolorscatter(this)">Black</button>
    <button id="1" class="button_color button1" onclick="setcolorscatter(this)">Green</button>
    <button id="2" class="button_color button2" onclick="setcolorscatter(this)">Blue</button>
    <button id="3" class="button_color button3" onclick="setcolorscatter(this)">red</button>
    <button id="4" class="button_color button4" onclick="setcolorscatter(this)">打叉叉</button>
    <button id="6" class="button_color button4" onclick="setcolorscatter(this)">跑飞了</button>

    <button id="6" onclick="clustering()">聚类</button>
    <button id="7" onclick="yiwanci()">一万次</button>
    <button id="8" onclick="dikaer()">笛卡尔</button>
    <button id="9" onclick="jizuobiao()">极坐标</button>
    <a onclick="exportCSV(this)" download="downlaod.csv" href="#">导出数据</a>


    <!--<button class="button">Button</button>-->
</div>

<div style="float:left">
    <div id="main" style="width: 600px;height:600px;"></div>
    <div style="float:left">
        <input type="range" id="myRange" value ="90" min="50" max="100" step="0.01" oninput="flitter()"/>
    </div>
    <div style="float:left">
        <p id="flitter">90.0%</p>
    </div>

<!--<button oninput="flitter()">flitter</button>-->

    <!--<div style="clear:both">-->

            <!--Xstart: <input type="text" id="x1" value="700"/>-->
            <!--Xend: <input type="text" id="x2" value="800"/>-->
            <!--<button id="7" class="change" onclick="changX()">改变X轴</button>-->
    <!--</div>-->

    <!--<div style="clear:both">-->

    <!--Ystart: <input type="text" id="y1" value="700"/>-->
    <!--Yend: <input type="text" id="y2" value="800"/>-->
    <!--<button id="8" class="change" onclick="changY()">改变Y轴</button>-->
<!--<div>-->
    <!--<form id="list1" method="post" action="">-->
        <!--<p\>五张板子-->
        <!--<input type="radio" name="banzi" value="0">0-->
        <!--<input type="radio" name="banzi" value="1">1-->
        <!--<input type="radio" name="banzi" value="2">2-->
        <!--<input type="radio" name="banzi" value="3">3-->
        <!--<input type="radio" name="banzi" value="4">4-->
    <!--</form>-->

    <!--<form id="list2" method="post" action="">-->
        <!--四个通道<input type="radio" name="tongdao" value="1">00-->
        <!--<input type="radio" name="tongdao" value="1">01-->
        <!--<input type="radio" name="tongdao" value="2">10-->
        <!--<input type="radio" name="tongdao" value="3">11-->
    <!--</form>-->


    <!--<button id="9" onclick="choose()">选择</button>-->


<!--</div>-->

</div>


<div style="float:left">
    <canvas id="bbb" width="800" height="600"></canvas>
</div>

<script type="text/javascript">


//------------------------这里是数据的初始化处理部分 临时使用------------------------------------


function exportCSV (aLink) {
    // 这里可以将后台返回的数据放入csvData，然后将其导出到csv保存

    data=datadikaer;

    var str="Numon384,Well96,SNP,HEX,FAM,result\n";
    for (var a=0;a<data.length;a++)
    {
        var SNP;
        var resultfh;

        switch(data[a][2]) {
            case 0 : resultfh="NTC"; break;
            case 1 : resultfh="YY"; break;
            case 2 : resultfh="XY"; break;
            case 3 : resultfh="XX"; break;
            case 4 : resultfh="Undetermined"; break;
            case 5 : resultfh="Undefined"; break;
            case 6 : resultfh="Empty"; break;


        }


        // if(Math.floor(a/24)%2==0)
        //     SNP=1;
        // else
        //     SNP=2;

        str+=data[a][8]+","+String.fromCharCode(Math.floor(a/12)+65).toString()+(a%12+1).toString()+","+(Math.floor(data[a][8]/24)%2+1).toString()+","+data[a][0]+","+data[a][1]+","+resultfh+"\n";

    }



     str =  encodeURIComponent(str);
    aLink.href = "data:text/csv;charset=utf-8,\ufeff"+str;
}



// -----------------------------这个是吧xy缩放到确定的位置----------

function changX()
{
    var x1=parseInt(document.getElementById("x1").value);
    var x2=parseInt(document.getElementById("x2").value);



    myChart.setOption({
        dataZoom: [{
           // type: 'value',
            xAxisIndex: 0,
            startValue: x1,
            endValue: x2
            //name:'FAM'

             },

            {
            // type: 'value',
            //yAxisIndex: 0,

            //name:'FAM'

        }


        ]
        })

}

function changY() {
    var y1 = parseInt(document.getElementById("y1").value);
    var y2 = parseInt(document.getElementById("y2").value);


    myChart.setOption({
        dataZoom: [
            {
                // type: 'value',
                //xAxisIndex: 0,

                //name:'FAM'

            },

            {
            // type: 'value',
            yAxisIndex: 0,
            startValue: y1,
            endValue: y2
            //name:'FAM'
            }


        ]
    })

}





function flitter() {
        var x = document.getElementById("myRange").value;

        document.getElementById("flitter").innerHTML = x+'%';

        quanlity=x;

        for(var n=0;n<96;n++){

            if (data[n][2]>0&&data[n][2]<5) {

                if (data[n][7] < quanlity / 100)     //判定阈值判断
                {
                    data[n][2] = 4;
                }
                else
                {
                    var maxnum = maxof3(data[n][4], data[n][5], data[n][6]);
                    data[n][2] = maxnum[0]+1;
                }

            }

        }

        refreshscatter();


    }




    var cishu=500;
    var quanlity=0.80;

    var zuobiaoxi=0; //目前选择的状态标记0表示笛卡尔 1表示极坐标


//------------------------一下是两个数组初始化datadikaer指向dikaer数组空间，datajizuobiao指向dikaer数组空间
//-------------------------坐标在初始化时候算死确定不用来回算，后面分组信息在单机按钮后相互转移


        var data=[];
        var datajizuobiao=[];
            var random = function (max){
                return ((Math.random()*max));
            };

       // 将数据装载到数组中
       //  for (var i = 0; i < 5; i++) {
       //      data.push([random(20)+10, random(20)+10,0,0,0,0,0,1]);
       //  };
       //  for (var i = 0; i < 24; i++) {
       //      data.push([random(50)+100, random(20)+10,5,0,0,0,0,1]);
       //  };
       //  for (var i = 0; i < 40; i++) {
       //      var a=random(100)
       //      data.push([random(20)+100, random(20)+100,5,0,0,0,0,1]);
       //  };
       //  for (var i = 0; i < 24; i++) {
       //      data.push([random(20)+10, random(100)+100,5,0,0,0,0,1]);
       //  };
       //  for (var i = 0; i < 3; i++) {
       //      data.push([random(100)+10, random(100)+10,5,0,0,0,0,1]);
       //  };


var fanyingban=1;


var weizhi1=0;
var weizhi2=0;


var datarawseries=

    [
        
[[0.288275,0.320062],
[0.347956,0.459736],
[1.220518,0.39704],
[0.45729,0.894052],
[1.119635,0.634359],
[0.427786,0.957761],
[1.123831,0.657037],
[0.465504,0.944028],
[1.264358,0.395514],
[0.521261,0.961548],
[1.195673,0.668985],
[0.879823,0.811848],
[1.191186,0.656637],
[0.449976,0.988732],
[1.277395,0.379963],
[0.873897,0.862855],
[1.256963,0.416577],
[0.439641,0.987859],
[0.314657,0.318744],
[0.342221,0.426503],
[0.874289,0.290365],
[0.386355,0.448848],
[1.249431,0.416485],
[0.537821,1.059288],
[0.107466,0.187781],
[0.093506,0.173033],
[0.556261,0.249484],
[0.156183,0.380983],
[0.512426,0.32211],
[0.159294,0.375737],
[0.51887,0.311643],
[0.150562,0.3372],
[0.584571,0.238243],
[0.153422,0.38249],
[0.537883,0.313181],
[0.363087,0.308645],
[0.530938,0.299787],
[0.143415,0.369704],
[0.584922,0.224104],
[0.35313,0.289177],
[0.575099,0.251715],
[0.127176,0.374235],
[0.114229,0.184876],
[0.077228,0.149982],
[0.160395,0.174557],
[0.086965,0.15342],
[0.580429,0.268658],
[0.159502,0.432291],
[1.189822,0.434366],
[0.434817,0.879323],
[1.13402,0.678562],
[0.530056,0.965364],
[1.235495,0.433893],
[0.847269,0.813873],
[1.17084,0.675651],
[0.867513,0.826094],
[1.168555,0.701728],
[0.503269,0.99811],
[1.172852,0.677335],
[0.84041,0.837659],
[1.241663,0.47079],
[0.501189,1.007299],
[1.161215,0.692914],
[0.838853,0.848884],
[1.221163,0.435646],
[0.773888,0.840352],
[0.314145,0.328933],
[0.329129,0.478336],
[0.470806,0.338405],
[0.350371,0.48149],
[1.200897,0.453304],
[0.851557,0.946921],
[0.568937,0.218766],
[0.602229,2.159023],
[0.516627,0.317949],
[0.233583,0.458717],
[0.586006,0.244666],
[0.39099,0.337333],
[0.544726,0.332586],
[0.395899,0.339937],
[0.532085,0.332375],
[0.179475,0.397802],
[0.538345,0.300602],
[0.358878,0.322766],
[0.56927,0.227738],
[0.147862,0.386397],
[0.503048,0.305436],
[0.334007,0.30519],
[0.568052,0.219468],
[0.348536,0.297316],
[0.105328,0.175788],
[0.09217,0.162734],
[0.101225,0.166596],
[0.120597,0.155588],
[0.552383,0.223969],
[0.344824,0.342008],
[1.2056,0.44045],
[0.493602,0.962984],
[1.228377,0.438712],
[0.891926,0.793046],
[1.251892,0.454815],
[0.928033,0.818213],
[1.256521,0.495583],
[0.560357,0.941124],
[1.254174,0.453355],
[0.542338,0.947097],
[1.266442,0.437565],
[0.899111,0.810837],
[1.231975,0.415085],
[0.445663,0.957543],
[0.317805,0.377779],
[0.362172,0.503115],
[1.156454,0.678682],
[0.499895,0.980381],
[1.158079,0.643063],
[0.48481,0.928429],
[1.226583,0.386533],
[0.804743,0.75908],
[0.858949,0.365294],
[0.345076,0.578478],
[0.561786,0.27647],
[0.18894,0.440408],
[0.574932,0.280269],
[0.383097,0.314241],
[0.581102,0.269278],
[0.387837,0.337389],
[0.583009,0.281259],
[0.188756,0.405136],
[0.576852,0.265027],
[0.177266,0.402483],
[0.575164,0.241861],
[0.353138,0.312115],
[0.557053,0.231937],
[0.133868,0.416165],
[0.109631,0.215616],
[0.098068,0.167965],
[0.522441,0.309371],
[0.143884,0.274841],
[0.527579,0.311105],
[0.156857,0.364454],
[0.572135,0.225843],
[0.306766,0.266401],
[0.135909,0.208074],
[0.100773,0.217546],
[1.2296,0.468692],
[1.096479,0.58533],
[1.223349,0.470314],
[0.872767,0.804705],
[1.243559,0.450582],
[0.566195,0.943732],
[1.246522,0.448702],
[0.960889,0.83887],
[1.248398,0.44993],
[0.51004,0.971938],
[1.148147,0.708495],
[0.474826,1.050524],
[0.442561,0.872278],
[0.469265,1.001675],
[1.210565,0.453904],
[0.504558,0.923045],
[1.267038,0.421707],
[0.916594,0.817133],
[1.23207,0.411815],
[0.878314,0.622931],
[0.903881,0.324972],
[0.413656,0.462049],
[1.226173,0.461148],
[0.484688,1.073661],
[0.581763,0.269603],
[0.53201,0.242461],
[0.59164,0.280646],
[0.399027,0.362578],
[0.586007,0.263584],
[0.18149,0.410591],
[0.576885,0.252143],
[0.398316,0.327314],
[0.582965,0.255344],
[0.166619,0.398477],
[0.511545,0.331295],
[0.154033,0.428399],
[0.18888,0.431885],
[0.151199,0.417482],
[0.573533,0.250658],
[0.18146,0.360519],
[0.588127,0.237495],
[0.384221,0.326422],
[0.530436,0.248863],
[0.364692,0.234205],
[0.333022,0.162492],
[0.125917,0.175539],
[0.559557,0.227212],
[0.176506,0.410821],
[1.175421,0.709122],
[0.54045,0.935719],
[1.249503,0.450132],
[0.560667,0.917539],
[1.1966,0.658396],
[0.53877,0.902763],
[1.246426,0.424918],
[1.16007,0.560635],
[1.233715,0.414648],
[0.808619,0.723151],
[1.24281,0.445798],
[0.849419,0.854489],
[1.162919,0.732304],
[0.916246,0.855651],
[1.275071,0.41494],
[1.187791,0.548039],
[1.205225,0.687347],
[0.53844,0.939203],
[1.253157,0.401018],
[0.518532,0.932099],
[1.157919,0.671893],
[0.887017,0.792918],
[1.025198,0.363256],
[0.846954,0.813157],
[0.554543,0.361587],
[0.201595,0.418749],
[0.593591,0.288562],
[0.189244,0.406169],
[0.517625,0.326637],
[0.167501,0.391447],
[0.582723,0.253022],
[0.531452,0.239448],
[0.582644,0.257754],
[0.357158,0.337802],
[0.587516,0.252483],
[0.353815,0.333617],
[0.518517,0.326011],
[0.37605,0.366962],
[0.583437,0.259142],
[0.51476,0.205743],
[0.515903,0.312197],
[0.164799,0.397534],
[0.575332,0.271445],
[0.155548,0.378186],
[0.511833,0.30993],
[0.273825,0.283205],
[0.528261,0.341442],
[0.354501,0.338689],
[1.272623,0.475796],
[0.596889,0.947806],
[1.289237,0.444294],
[0.899436,0.770782],
[1.25554,0.419433],
[0.88217,0.792067],
[1.254782,0.435349],
[0.449917,0.825626],
[1.261175,0.444671],
[0.519383,0.981449],
[1.24946,0.436925],
[0.490258,0.989993],
[1.28014,0.504386],
[1.126858,0.598948],
[1.18539,0.635607],
[0.517017,0.906108],
[1.244083,0.412845],
[0.862579,0.751658],
[1.25016,0.388685],
[1.088637,0.557557],
[1.165987,0.663227],
[0.525789,0.965008],
[0.948709,0.374871],
[0.377389,0.528957],
[0.5806,0.265586],
[0.187305,0.40959],
[0.622991,0.246103],
[0.379134,0.317409],
[0.572827,0.223757],
[0.37782,0.336372],
[0.571399,0.227808],
[0.164314,0.409832],
[0.575895,0.259683],
[0.161502,0.413996],
[0.567777,0.240257],
[0.154127,0.403246],
[0.580861,0.250498],
[0.488275,0.239028],
[0.523634,0.290013],
[0.152089,0.384199],
[0.577586,0.232061],
[0.356336,0.309128],
[0.58034,0.223584],
[0.501907,0.212576],
[0.504584,0.306307],
[0.161586,0.407102],
[0.120443,0.197171],
[0.086267,0.175045],
[1.184856,0.697869],
[0.502954,0.918352],
[1.170323,0.662303],
[0.467926,0.838305],
[1.230873,0.399261],
[0.504382,0.925575],
[1.172838,0.674089],
[0.504795,0.948222],
[1.207317,0.65746],
[0.833669,0.787134],
[1.277142,0.438105],
[0.516277,0.965042],
[1.282592,0.421086],
[0.52292,0.936008],
[1.2653,0.413592],
[0.531455,0.920247],
[1.280884,0.419259],
[0.53799,0.921417],
[1.270677,0.400066],
[0.507949,0.926646],
[1.187965,0.667256],
[0.495992,0.932782],
[1.221029,0.404972],
[0.460373,0.973693],
[0.553552,0.34656],
[0.162557,0.40463],
[0.526738,0.332201],
[0.146562,0.382932],
[0.554576,0.254861],
[0.146831,0.398257],
[0.516992,0.31516],
[0.154589,0.399092],
[0.514823,0.327099],
[0.333363,0.30972],
[0.578034,0.250577],
[0.152755,0.399998],
[0.578717,0.257348],
[0.159716,0.395576],
[0.580956,0.258028],
[0.164731,0.384688],
[0.574486,0.252708],
[0.164204,0.399148],
[0.564988,0.286608],
[0.162605,0.389076],
[0.516049,0.320865],
[0.157589,0.39673],
[0.562754,0.232119],
[0.1554,0.396281],
[1.249217,0.472577],
[0.469269,0.967147],
[1.215359,0.454587],
[0.83316,0.806718],
[1.144661,0.693659],
[0.476176,0.982819],
[1.176565,0.69583],
[0.489909,0.96577],
[1.262035,0.427623],
[0.877349,0.818883],
[1.265783,0.440929],
[0.511904,1.007287],
[1.284453,0.443635],
[0.937603,0.810267],
[1.296525,0.409104],
[0.835064,0.805238],
[1.287994,0.429823],
[0.502608,1.001729],
[0.582271,0.84837],
[0.897389,0.812639],
[1.276815,0.423862],
[0.543324,0.969051],
[1.235892,0.433626],
[0.863314,0.890674],
[0.546395,0.247921],
[0.136092,0.397861],
[0.545978,0.234831],
[0.331209,0.327475],
[0.487932,0.301396],
[0.137845,0.414201],
[0.493016,0.306973],
[0.132251,0.399447],
[0.550009,0.241482],
[0.333164,0.328687],
[0.543721,0.226422],
[0.129649,0.404415],
[0.566597,0.226777],
[0.358803,0.3289],
[0.561379,0.207983],
[0.334137,0.308063],
[0.566466,0.22872],
[0.134526,0.396752],
[0.184067,0.387851],
[0.357008,0.305734],
[0.563226,0.21547],
[0.156677,0.39338],
[0.550274,0.213795],
[0.348186,0.32263]],


[[0.233437,0.387207],
[0.225563,0.51671],
[1.137218,0.441012],
[0.33463,0.999028],
[1.067462,0.722389],
[0.332981,1.059895],
[1.079067,0.735898],
[0.343299,1.042554],
[1.176962,0.447964],
[0.352753,1.062708],
[1.112792,0.738585],
[0.767974,0.923319],
[1.105585,0.737632],
[0.333555,1.083858],
[1.20183,0.450715],
[0.757815,0.888149],
[1.187945,0.444479],
[0.345767,1.052681],
[0.944621,0.370743],
[0.242846,0.519484],
[1.086013,0.377499],
[0.25782,0.553778],
[1.163715,0.519029],
[0.336326,1.210958],
[0.071626,0.252531],
[0.076788,0.231167],
[0.527971,0.302241],
[0.128267,0.460709],
[0.482263,0.376874],
[0.122414,0.439769],
[0.488123,0.351635],
[0.12304,0.401738],
[0.548571,0.265524],
[0.121697,0.460068],
[0.496735,0.354291],
[0.312777,0.369136],
[0.497718,0.335418],
[0.113246,0.427654],
[0.539703,0.238777],
[0.312822,0.337815],
[0.533914,0.273788],
[0.108419,0.441156],
[0.079022,0.213771],
[0.065275,0.204411],
[0.258837,0.234865],
[0.078701,0.242218],
[0.525593,0.336383],
[0.110891,0.485863],
[1.099359,0.499945],
[0.344739,0.99854],
[1.007992,0.76037],
[0.348728,1.028366],
[1.100434,0.502075],
[0.701294,0.921606],
[1.045482,0.776329],
[0.704841,0.933468],
[1.065167,0.79896],
[0.367845,1.147189],
[1.083486,0.777359],
[0.727591,0.962308],
[1.157801,0.536327],
[0.36948,1.115956],
[1.076963,0.753695],
[0.717363,0.924503],
[1.14536,0.497257],
[0.704856,0.933907],
[0.504716,0.429735],
[0.228533,0.569673],
[0.911606,0.44288],
[0.26437,0.610329],
[1.113564,0.547399],
[0.719266,1.068156],
[0.54552,0.267251],
[0.131295,0.443396],
[0.488184,0.380921],
[0.134697,0.461802],
[0.536935,0.278912],
[0.338798,0.391285],
[0.494115,0.385631],
[0.33459,0.403143],
[0.477682,0.37664],
[0.121678,0.460354],
[0.494398,0.346037],
[0.327707,0.369748],
[0.532154,0.270535],
[0.109007,0.427337],
[0.477893,0.339014],
[0.318053,0.357238],
[0.528981,0.24612],
[0.30411,0.372839],
[0.088568,0.231921],
[0.065122,0.215708],
[0.080835,0.22748],
[0.082502,0.233203],
[0.528072,0.281622],
[0.323942,0.446981],
[0.896247,0.439882],
[0.353433,0.989039],
[1.112314,0.503581],
[0.754469,0.915032],
[1.141093,0.504504],
[0.759636,0.915171],
[1.123205,0.53077],
[0.371461,1.053867],
[1.1358,0.522584],
[0.345601,1.063318],
[1.16303,0.513526],
[0.74564,0.908189],
[1.156618,0.462838],
[0.304667,1.034549],
[0.241756,0.423493],
[0.245162,0.558908],
[1.04434,0.771005],
[0.345792,1.096394],
[1.038623,0.734916],
[0.325939,1.048063],
[1.080768,0.477514],
[0.601677,0.884432],
[1.007464,0.452208],
[0.242241,0.66472],
[0.531779,0.30571],
[0.133155,0.456913],
[0.538773,0.29774],
[0.349731,0.397796],
[0.543583,0.316844],
[0.340124,0.398123],
[0.536211,0.304897],
[0.136219,0.48404],
[0.532724,0.302643],
[0.12227,0.458188],
[0.529787,0.27668],
[0.316339,0.358207],
[0.520381,0.259099],
[0.103113,0.450355],
[0.32516,0.23841],
[0.072114,0.214154],
[0.468677,0.353983],
[0.121819,0.470308],
[0.487358,0.363507],
[0.1229,0.451955],
[0.529117,0.29685],
[0.241342,0.354948],
[0.411902,0.277997],
[0.070168,0.273052],
[1.135976,0.529049],
[1.028779,0.69323],
[1.128973,0.508742],
[0.758617,0.904777],
[1.138623,0.498696],
[0.382543,1.043058],
[1.12487,0.510026],
[0.764172,0.942188],
[1.133518,0.523763],
[0.338743,1.072454],
[1.048677,0.770855],
[0.311707,1.106207],
[0.344383,0.906801],
[0.334128,1.073532],
[1.132446,0.487398],
[0.328821,0.982836],
[1.133677,0.506627],
[0.755424,0.943334],
[1.116844,0.508167],
[0.743532,0.677901],
[0.992842,0.45279],
[0.270346,0.614335],
[1.094385,0.555749],
[0.317288,1.171764],
[0.550394,0.307717],
[0.495124,0.282571],
[0.542185,0.305043],
[0.344807,0.388214],
[0.527742,0.305521],
[0.125292,0.462326],
[0.538194,0.303933],
[0.346738,0.382272],
[0.539403,0.285],
[0.117328,0.457658],
[0.478227,0.374196],
[0.100649,0.459769],
[0.125768,0.466463],
[0.113136,0.458081],
[0.533336,0.278425],
[0.109891,0.411365],
[0.540435,0.281099],
[0.360625,0.389949],
[0.5158,0.293281],
[0.331593,0.279325],
[0.315028,0.230306],
[0.099703,0.254467],
[0.514804,0.279803],
[0.112461,0.490401],
[1.060506,0.785064],
[0.350236,1.032912],
[1.122753,0.495004],
[0.348731,1.027339],
[1.042736,0.752155],
[0.340998,0.922335],
[1.13603,0.486824],
[1.037697,0.654792],
[1.166566,0.482866],
[0.748049,0.919061],
[1.165113,0.497611],
[0.743551,0.913634],
[1.065777,0.773802],
[0.759171,0.90234],
[1.167338,0.467601],
[1.054654,0.620017],
[1.082399,0.762767],
[0.525005,1.054069],
[1.172609,0.458154],
[0.38563,1.019833],
[1.026278,0.757796],
[0.710479,0.900454],
[1.051958,0.459531],
[0.215253,0.650353],
[0.489093,0.406719],
[0.114986,0.444873],
[0.536124,0.314786],
[0.121526,0.442882],
[0.470748,0.371743],
[0.118392,0.447137],
[0.536841,0.279674],
[0.494897,0.26912],
[0.547463,0.307122],
[0.332318,0.378794],
[0.542424,0.283042],
[0.311216,0.353617],
[0.490392,0.364554],
[0.344999,0.377449],
[0.551353,0.277447],
[0.500665,0.26274],
[0.502384,0.365805],
[0.182637,0.461142],
[0.553576,0.281779],
[0.144001,0.448971],
[0.482154,0.375381],
[0.323224,0.39149],
[0.114206,0.296988],
[0.06679,0.253421],
[1.14098,0.484055],
[0.331778,0.994807],
[1.123881,0.476104],
[0.703175,0.864338],
[1.141658,0.474745],
[0.744288,0.883836],
[1.147117,0.488572],
[0.371953,1.076228],
[1.156737,0.518977],
[0.370207,1.085479],
[1.158381,0.491559],
[0.350577,1.067824],
[1.162068,0.552261],
[0.985975,0.718129],
[1.090718,0.730835],
[0.368571,1.015672],
[1.152128,0.467376],
[0.732031,0.900571],
[1.156821,0.463526],
[0.991509,0.665603],
[1.037164,0.785047],
[0.353152,1.057866],
[0.955517,0.441742],
[0.231175,0.642438],
[0.530954,0.304245],
[0.118108,0.468466],
[0.522115,0.274347],
[0.310779,0.351667],
[0.535078,0.269093],
[0.336232,0.376513],
[0.535469,0.295912],
[0.113473,0.470377],
[0.530216,0.289774],
[0.114926,0.448993],
[0.532556,0.285604],
[0.112256,0.457338],
[0.528634,0.278433],
[0.455259,0.268656],
[0.478073,0.333181],
[0.10561,0.43521],
[0.531774,0.260435],
[0.319687,0.38644],
[0.540447,0.274193],
[0.476854,0.274082],
[0.484125,0.373937],
[0.115836,0.472606],
[0.332866,0.246597],
[0.054617,0.221877],
[1.050669,0.754709],
[0.318469,0.98703],
[1.027452,0.724683],
[0.331171,1.004398],
[1.123414,0.458667],
[0.335443,1.029444],
[1.043119,0.765614],
[0.322215,1.066762],
[1.056479,0.746785],
[0.687348,0.86306],
[1.161382,0.47904],
[0.330521,1.069165],
[1.161596,0.474889],
[0.36428,1.051258],
[1.14503,0.481641],
[0.337997,1.042023],
[1.153114,0.474867],
[0.352823,1.039876],
[1.133938,0.464917],
[0.35599,1.042557],
[1.052821,0.765212],
[0.329551,1.0524],
[1.120401,0.473503],
[0.296018,1.120426],
[0.474918,0.367247],
[0.114974,0.441576],
[0.469219,0.36717],
[0.102291,0.42313],
[0.521123,0.311185],
[0.109728,0.449145],
[0.473329,0.386176],
[0.15461,0.453703],
[0.470533,0.375836],
[0.298696,0.349752],
[0.531253,0.288415],
[0.106635,0.446782],
[0.532826,0.307227],
[0.114244,0.447509],
[0.529391,0.300605],
[0.123805,0.443218],
[0.529916,0.300168],
[0.116827,0.453288],
[0.524067,0.300231],
[0.12821,0.462445],
[0.464608,0.348118],
[0.112278,0.452747],
[0.516865,0.304225],
[0.10738,0.453782],
[0.748358,0.41224],
[0.190003,0.458712],
[0.882009,0.398781],
[0.251431,0.578631],
[1.042057,0.754393],
[0.32747,1.088537],
[1.059155,0.772899],
[0.34149,1.055068],
[1.162152,0.474856],
[0.733212,0.901151],
[1.17393,0.475714],
[0.34074,1.086523],
[1.17703,0.493779],
[0.754142,0.913051],
[1.170174,0.469961],
[0.686205,0.873372],
[1.156182,0.483251],
[0.321612,1.09074],
[0.333238,0.94159],
[0.706246,0.896839],
[1.123869,0.481117],
[0.355726,1.068782],
[1.115311,0.495387],
[0.711333,1.006378],
[0.08837,0.239084],
[0.060879,0.214666],
[0.511041,0.262909],
[0.323415,0.387103],
[0.472731,0.362739],
[0.102893,0.452352],
[0.465917,0.355841],
[0.097947,0.445791],
[0.52061,0.273721],
[0.316038,0.366648],
[0.525255,0.26552],
[0.096479,0.445301],
[0.529037,0.24621],
[0.325328,0.365022],
[0.528674,0.259151],
[0.287477,0.357503],
[0.528468,0.275409],
[0.097344,0.472607],
[0.151196,0.457022],
[0.299651,0.366679],
[0.515935,0.263178],
[0.101387,0.456999],
[0.506458,0.271008],
[0.294594,0.38184]]


    ];





       // var dataraw=datarawseries[0];


        data=[];
        for (var a=0;a<datarawseries[fanyingban].length;a++)
        {
            if((Math.floor(a/24))%2==weizhi1&&(a%24)%2==weizhi2)
            {


                data.push([datarawseries[fanyingban][a][0], datarawseries[fanyingban][a][1], 5, 0, 0, 0, 0, 1, a]); //5是灰色的还没有聚类状态




            }





            

        }




        // for ( i = 0; i < 4; i++) {
        //     data.push([random(990), random(990),5,0,0,0,0,1,0]);
        // };

        var datadikaer =data;       //datadikaer初始化

        for (var i=0;i<datadikaer.length;i++)    //datajizuobiao初始化
        {
            r=Math.log10((Math.sqrt(datadikaer[i][0]*datadikaer[i][0]+datadikaer[i][1]*datadikaer[i][1])));
            therta=Math.atan(datadikaer[i][1]/datadikaer[i][0]);

            datajizuobiao.push([r,therta,datadikaer[i][2],datadikaer[i][3],datadikaer[i][4],datadikaer[i][5],datadikaer[i][6],datadikaer[i][7]]);

        }



        function jizuobiao()
        {
            if (zuobiaoxi==0)
            {
                zuobiaoxi=1;

                selected=[];  //选择清空

                for (var i = 0; i < datadikaer.length; i++) {
                    for (var j = 2; j < 9; j++)

                        datajizuobiao[i][j] = datadikaer[i][j];

                }

                data = datajizuobiao;      //data指向极坐标

                refreshscatter();
            }


        }

        function dikaer()
        {
            if(zuobiaoxi==1) {

        zuobiaoxi=0;
                selected=[];  //选择清空
                for (var i = 0; i < datadikaer.length; i++) {
                    for (var j = 2; j < 9; j++)

                        datadikaer[i][j] = datajizuobiao[i][j];

                }

                data = datadikaer;   //data指向笛卡尔

                refreshscatter();
            }
        }











        // 基于准备好的dom，初始化echarts实例

        // var data = [];//数据区域缩放组件
        var fenzu=[[],[],[],[]];
        var zhuadaode=[[],[],[],[]];

        var myChart = echarts.init(document.getElementById('main'));

        // function savepic()
        // {
        //     //  var img = new Image();
        //     varaaa = myChart.getDataURL({
        //         type:'jpeg',
        //         pixelRatio: 1,
        //         //backgroundColor: '#fff'
        //         excludeComponents: ['toolbox']
        //     });



         //   }






        var selectchange =1;
        var deepcopy=[];


        function maxof3 (a,b,c)
        {
            var max=a,num=0;
            if (max<b) {
                max = b;
                num=1;
            }
            if (max<c) {
                max = c;
                num=2;
            }


            return [num,max]


        }
    //------------------------聚类一万次---------------------------


        function yiwanci()
    {



//清空
        for(var n=0;n<96;n++){


            data[n][3]=data[n][4]=data[n][5]=data[n][6]=data[n][7]=0;
           //黑色

        }




        for(var i=0;i<cishu;i++)
        {



            clustering();

            for(var n=0;n<96;n++){

             //   if(data[n][2]>0&&data[n][2]<5)
                data[n][data[n][2]+3]++;

            }

        }


         for(var n=0;n<96;n++){
        //


             if(data[n][2]>0) {

                 var maxnum = maxof3(data[n][4], data[n][5], data[n][6]);
                 data[n][2] = maxnum[0] + 1;
                 data[n][7] = maxnum[1] / cishu;

                 if (data[n][7] < quanlity)     //判定阈值判断
                     data[n][2] = 4;
             }



        }





        flitter();

        //refreshscatter();


    }






        var result;
        var ordercentroids=[];
        var nnn=0;

//--------------------聚类!!!!!!!!!!!!!!!!!!!!!!!!!-3类----------------------------------------

        function clustering() {

            var count = 0;

            console.log('clustering');
            var clusterNumber = 3;
            var dataclustering=[];//清空


            //采集需要聚类的点放入dataclustering

            // if(zuobiaoxi==0)
            // {
            //     data=datadikaer;
            //
            // }
            // else
            //     if(zuobiaoxi==1)
            //     {
            //         data=datajizuobiao
            //
            //     }
            //


            for (var i=0;i<data.length;i++)
            {
                if(data[i][2]!=0&&data[i][2]!=4&&data[i][2]!=6)   //NTC和叉叉和跑飞不参与聚类
                    dataclustering.push([data[i][0]*1000,data[i][1]*1000,i]); //放大一千倍放进去聚类
            }



//console.log("stop");

            result = ecStat.clustering.hierarchicalKMeans(dataclustering, clusterNumber, false);

//有时候分出来不是四个组很奇怪。


            // for (var a = 0; a < result.centroids.length; a++) {
            //     if (result.centroids[a].length > 0)
            //         count++;
            //
            // }

            // if (count<4)
            //     n++;

            //console.log(count);

            // if (count<3)    //变态的是 测试了很久很久 这个kmean聚类返回的结果可能不是4类 我也是醉了 小于3重来
            // {
            //     clustering();
            //
            // }

            //----------------------------一下才是3组的处理内容
//             else
//             {
//
//
            if (zuobiaoxi==0)
            {
                ordercentroids = [
                    [result.centroids[0][1] / result.centroids[0][0], 0],
                    [result.centroids[1][1] / result.centroids[1][0], 1],
                    [result.centroids[2][1] / result.centroids[2][0], 2]
                    //  [result.centroids[3][0], result.centroids[3][1]]

                ];  //复制出来加一位
            }

            if (zuobiaoxi==1)
            {
                ordercentroids = [
                    [result.centroids[0][1] , 0],
                    [result.centroids[1][1] , 1],
                    [result.centroids[2][1] , 2]
                    //  [result.centroids[3][0], result.centroids[3][1]]

                ];  //复制出来加一位
            }





                //
                //=---------------------排序

                ordercentroids.sort(function (a, b) {
                    return b[0]-a[0];
                });                            //按照x坐标排序 序号记录进入第四位


                for (var i = 0; i < ordercentroids.length; i++)  //加一位 插入原始序号

                {
                    ordercentroids[i].push(i);  //排序后序号

                }
//
//
                ordercentroids.sort(function (a, b) {
                    return a[1]-b[1];
                });                                              //在排回去





//                 if (ordercentroids[0][1] > ordercentroids[1][1]) {
//                     ordercentroids[0][3] = 1;
//                     ordercentroids[1][3] = 0;
//
//                 }
//
//
//                 if (ordercentroids[2][1] > ordercentroids[3][1]) {
//                     ordercentroids[2][3] = 3;
//                     ordercentroids[3][3] = 2;
//
//                 }
//
// //-----------------以下这个循环不是人类可以理解的 如果正确了 那么分组将按照顺序赋值给原始数据的分组项
//                 //-----------------如果错了 我也想不出来怎么调试了 但是不幸的是 他对了
//
//
//
//
//                 for (var i = 0; i < 96; i++) {
//
//                     //         console.log(result.clusterAssment[i][0]);
//
//                     //        data[i][2]=result.clusterAssment[i][0];
//
//
//                     for (var n = 0; n < ordercentroids.length; n++) {
//                         if (result.clusterAssment[i][0] === ordercentroids[n][2]) {
//                             data[i][2] = ordercentroids[n][3]
//                         }
//
//                     }
//
//                 }

//-----------------------------------------------------------------------------
//                else

            for (var n = 0; n < dataclustering.length; n++)                   //逆天的操作啊
            {
                data[dataclustering[n][2]][2]=ordercentroids[result.clusterAssment[n][0]][2]+1;   //分组的颜色直接染给对应的data

            }


                colorscattortopanel();


                refreshscatter();
                refreshpanel();
             //   console.log(nnn++);





        }

        function initscatter()
        {

            //构造随机数
            // var random = function (max){
            //     return ((Math.random()*max));
            // };

            //将数据装载到数组中
            // for (var i = 0; i < 25; i++) {
            //     data.push([random(99), random(99),0]);
            // };
            //
            // for ( i = 25; i < 50; i++) {
            //     data.push([random(99), random(99),1]);
            // };
            //
            // for ( i = 50; i < 75; i++) {
            //     data.push([random(99), random(99),2]);
            // };
            //
            // for ( i = 75; i < 100; i++) {
            //     data.push([random(99), random(99),3]);
            // };

            refreshscatter();


            initcanvaspanel();

        }

        function refreshscatter(){

//console.log('refresh');
            //myChart.clear();
                  //0  1  2  3  4   5   6
                  //b  g  b  r  x   n   feile
            fenzu=[[],[],[], [],[],[], []];

           // var select=[];

            for (var i = 0; i < 96; i++){
                fenzu[data[i][2]].push([data[i][0],data[i][1],i]);  //i表示在原数组中的位置
            }




            option = {

                tooltip : {
                    // padding: 10,
                    trigger: 'item',
                    //trigger: 'axis',
                    axisPointer: {
                        type: 'cross'

                    },
                    formatter: '{b}',
                },

                toolbox: {
                    left: 'right',
                    itemSize: 25,
                    top: 5,
                    feature: {
                        myTool1: {
                            show: true,
                            title: '保存图片',
                            icon: 'image://http://echarts.baidu.com/images/favicon.png',
                            //onclick: savepic()


                        },

                        // brush:{
                        //     type: 'rect',
                        //
                        // },
                        //
                        // brush:{
                        //     type: 'polygon',
                        //
                        // },

                        dataZoom: {

                        },



                        //
                        //
                        // myTool2: {
                        //     show: true,
                        //     title: '设置Y轴',
                        //     icon: 'image://http://echarts.baidu.com/images/favicon.png',
                        //     onclick: function () {
                        //         alert('myToolHandler2')
                        //     }
                        //
                        // },


                        restore: {},




                    },

                },



                brush:
                    {
                        toolbox:['rect','polygon','clear'],

                        brushType: 'rect',


                        romoveOnClick:'signle'    //单击空白处清空选择
                    },


                xAxis: {
                    type: 'value',
                    scale: true,
                    min: function(value) {
                        return value.min-(value.max-value.min)*0.1 ;
                    },
                   max: function(value) {
                       return value.max+(value.max-value.min)*0.1 ;
                   },
                    name:'HEX',
                    nameLocation: 'center',
                    nameGap: 20,
                    nameTextStyle: {



                        fontSize: 18

                        // verticalAlign: ...,
                        // lineHeight: ...,

                    }
                }
                ,


                yAxis:
                    {
                        type: 'value',
                        scale: true,
                        min: function(value) {
                            return value.min-(value.max-value.min)*0.1 ;
                        },
                        max: function(value) {
                            return value.max+(value.max-value.min)*0.1;
                        },
                        name:'FAM',
                        nameLocation: 'center',
                        nameGap: 20,
                        nameTextStyle: {


                            fontSize: 18,

                            // verticalAlign: ...,
                            // lineHeight: ...,

                        }
                    }
                ,


                dataZoom: [
                    // 这个dataZoom组件，也控制y轴。

                    {
                        type: 'slider',
                        show: true,
                        xAxisIndex: 0,
                         //start: 0,
                         //end: 110
                    },


                    {   // 这个dataZoom组件，也控制x轴。
                        type: 'inside', // 这个 dataZoom 组件是 inside 型 dataZoom 组件
                        xAxisIndex: 0,
                        filterMode: 'empty',
                         // start: 10,      // 左边在 10% 的位置。
                         // end: 110         // 右边在 60% 的位置。
                    },

                    {
                        type: 'slider',
                        show: true,
                        yAxisIndex: 0,
                        // start: 1,
                        // end: 35
                    },


                    {
                        type: 'inside',
                        yAxisIndex: 0,
                        filterMode: 'empty',
                         // start: 10,
                         // end: 110
                    }


                ],


                series: [

                    {
                        animation: false,
                        name: 'black',
                        type: 'scatter',
                        symbolSize: 10,
                        z:'0',

                        data: fenzu[0],
                        itemStyle: {
                            color: '#000000'
                        },
                        symbol:'rect',

                    },


                    {
                        animation: false,
                        name:'green',
                        type: 'scatter',
                        symbolSize: 10,
                        z:'0',

                        data: fenzu[1],


                        itemStyle: {
                            color: '#4caf50'
                        }


                    },

                    {
                        animation: false,
                        name: 'blue',
                        type: 'scatter',
                        symbolSize: 10,
                        z:'0',

                        data: fenzu[2],


                        itemStyle: {
                            color: '#008cba'
                        },

                     //   symbol:'rect',

                    },

                    {
                        animation: false,
                        name:'red',
                        type: 'scatter',
                        symbolSize: 10,
                        z:'0',

                        data: fenzu[3],


                        itemStyle: {
                            color: '#b80af4'
                        },
                    //    symbol: 'triangle'


                    },


                    {
                        animation: false,
                        name: 'chacha',
                        type: 'scatter',
                        symbolSize: 10,
                        z: '0',

                        data: fenzu[4],


                        itemStyle: {
                            color: '#ff1736'
                        },

                        symbol: 'triangle'


                    },

                    {
                        animation: false,
                        name: 'none',
                        type: 'scatter',
                        symbolSize: 10,
                        z: '0',

                        data: fenzu[5],


                        itemStyle: {
                            color: '#636363'
                        },

                   //     symbol: 'triangle'


                    },


                    {
                        animation: false,
                        name: 'none',
                        type: 'scatter',
                        symbolSize: 10,
                        z: '0',

                        data: fenzu[6],


                        itemStyle: {
                            color: '#dadada'
                        },

                        //     symbol: 'triangle'


                    },



                    {
                        animation: false,
                        name: 'select',
                        type: 'scatter',
                        symbolSize: 20,
                        z: '0',

                        data: selected,


                        itemStyle: {
                            color: '#19f8ff',

                            opacity: 0.6


                        },

                       //symbol: 'rect'



                    }


                ]
            };



            // 使用刚指定的配置项和数据显示图表。
            myChart.setOption(option);


        }



myChart.on('brush', function ()          //这个事件用来出发清除panel选框
{


    hahaha=[
        [0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0]


    ];







});




        myChart.on('brushSelected', function (params) {
            //var brushComponent = params.batch[0];

            //var sum = 0; // 统计选中项的数据值的和
           // var xuhao;


            selectchange=1;
            zhuadaode=params.batch[0];
            deepcopy=[];


          //  selected=[];
   //         refreshscatter();


            console.log('hahaha');
            for (var sIdx = 0; sIdx < zhuadaode.selected.length-1; sIdx++)   //减一的目的是吧select的序列减去
            {
                // 对于每个 series：
                var dataIndices = zhuadaode.selected[sIdx].dataIndex;
                //
                for (var i = 0; i < dataIndices.length; i++) {
                    var dataIndex = dataIndices[i];
                    xuhao=fenzu[sIdx][dataIndex][2];
                    console.log(xuhao);
                    deepcopy.push(xuhao);
                }
            }


            // for (i = 0; i < zhuadaode.length; i++)
            //     console.log(zhuadaode[i]); // 显示抓到的数组下标//


            selectscattortopanel();





        });



        //--------------------------------------点击红色的函数-----------------------------------
        function setcolorscatter(obj)
        {

            var num=obj.id;

            console.log(num);


            //去跟新到每个点序列里面



          //  selectchange=0;   //!!!!!!!!


            //---------------------scatter的选择结果被染色-------------------


            for (var i=0;i<deepcopy.length;i++) {
                var a=deepcopy[i];
                data[a][2]=parseInt(num);
                console.log(deepcopy[i]);
                //cococo也染色
                cococo[parseInt(a / lie)+1][a % lie+1] = parseInt(num); //点击后 颜色直接过去
            }

            //---------------------------panel的选择结果也需要被染色------------------


            //
            // for (var j=0;j<selected.length;j++) {
            //     data[selected[j][2]][2]=parseInt(num);
            //
            //
            // }





            refreshscatter();

             refreshpanel();

        }


function colorscattortopanel() {

    cococo = [
        [9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9],
        [9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9],
        [9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9],
        [9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9],
        [9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9],
        [9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9],
        [9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9],
        [9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9],
        [9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9]

    ];//面板标记颜色清空


    for (var a = 0; a < data.length; a++) {
        {

            cococo[parseInt(a / lie) + 1][a % lie + 1] = data[a][2];

        }


    }

}

function selectscattortopanel() {

    // hahaha = [
    //     [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    //     [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    //     [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    //     [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    //     [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    //     [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    //     [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    //     [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    //     [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
    // ];  //panel先清空


    for (var i = 0; i < deepcopy.length; i++) {
        {
            var a = deepcopy[i];
            hahaha[parseInt(a / lie) + 1][a % lie + 1] = 1;

        }


    }


    refreshpanel();


}


var selected=[]; //这个全局数组标志


function selectpaneltoscatter() {


//先要清空sctter选区 ！！！！！

    selected=[];


    for (var i = 0; i < hang; i++)
    {
        for (var j = 0; j < lie; j++)
        {
            if(hahaha[i+1][j+1]==1)
            {


                selected.push([data[lie * i + j][0],data[lie * i + j][1],lie * i + j]);
                console.log(lie * i + j);

            }
        }

    }

    refreshscatter();

}


var panelsize=55; //panel棋盘边长可调节
var hang=8,lie=12;  //棋盘行列数 可调节
var hahaha=[
    [0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0]


];//panel被选中数组
var nonono=[
    [0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0]

];//鼠标移动时候被选中临时数组 加一个头标记整个行列选中
var cococo=[
    [9,9,9,9,9,9,9,9,9,9,9,9,9],
    [9,9,9,9,9,9,9,9,9,9,9,9,9],
    [9,9,9,9,9,9,9,9,9,9,9,9,9],
    [9,9,9,9,9,9,9,9,9,9,9,9,9],
    [9,9,9,9,9,9,9,9,9,9,9,9,9],
    [9,9,9,9,9,9,9,9,9,9,9,9,9],
    [9,9,9,9,9,9,9,9,9,9,9,9,9],
    [9,9,9,9,9,9,9,9,9,9,9,9,9],
    [9,9,9,9,9,9,9,9,9,9,9,9,9]

];//面板标记颜色



        function refreshpanel()   //obj是文档元素canvas传递过来 增加效率
        {  //画圈圈和框框

            var oncanvas = document.getElementById('bbb');
            var ctx = oncanvas.getContext('2d');


            ctx.clearRect(0,0,1000,1000);   //这里应该是获取画布的长和宽

        //----------------------------画边框

            for (var i = 1; i <= hang; i++)
            {
                ctx.beginPath();
                ctx.lineWidth=2;
                ctx.strokeRect(0, (i-1) * panelsize+0.4*panelsize, 0.4*panelsize, panelsize);


                ctx.font ='18px 微软雅黑 bold';
                ctx.fillStyle = '#000000';
                var Ax=String.fromCharCode(64+i);

                ctx.textAlign="center";

                ctx.fillText(Ax ,0.2*panelsize, i * panelsize);



                if (hahaha[i][0]>0 || nonono[i][0]>0)  //如果整个行被选中
                {


                   // console.log(i);
                    ctx.fillStyle =ctx.strokeStyle = 'rgba(55,55,55,0.5)';

                    ctx.fillRect(0, (i-1) * panelsize+0.4*panelsize, 0.4*panelsize, panelsize); //表头

                }

                ctx.closePath();

            }


            for (var j = 1; j <= lie; j++)
            {


                ctx.beginPath();
                ctx.lineWidth=2;
                ctx.strokeRect((j-1) * panelsize+0.4*panelsize, 0, panelsize, 0.4*panelsize);

                ctx.font ='18px 微软雅黑 bold';
                ctx.fillStyle = '#000000';
                var Ax=j.toString();

                ctx.textAlign="end";

                ctx.fillText(Ax ,j*panelsize, 0.3*panelsize);



                if (hahaha[0][j]>0 || nonono[0][j]>0)  //如果整个被选中
                {
                   // console.log(i);
                    ctx.fillStyle =ctx.strokeStyle = 'rgba(55,55,55,0.5)';

                    ctx.fillRect((j-1) * panelsize+0.4*panelsize,0,panelsize, 0.4*panelsize);
                    
                }
                ctx.closePath();

            }

            //---------------------------画面板
            ctx.save();
            ctx.translate(panelsize*0.4,panelsize*0.4);
            for (var i = 0; i < hang; i++)
            {
                for (var j = 0; j < lie; j++)
                {
                    //ctx.fillStyle =ctx.strokeStyle = 'rgb(0,' + Math.floor(255 - 255/lie * j) + ',' + Math.floor(255 - 255/hang * i) + ')';
                    ctx.fillStyle =ctx.strokeStyle ="black";

                    ctx.beginPath();
                    ctx.lineWidth=2;
                    ctx.strokeRect(j * panelsize, i * panelsize, panelsize, panelsize);  //画框框
                    //出点点
                    // ctx.font ='1px 微软雅黑 bold';
                    // ctx.fillStyle = '#000000';
                    // var Ax=String.fromCharCode(64+i+1)+(j+1).toString();
                    //
                    // ctx.textAlign="end";
                    //
                    // ctx.fillText(Ax ,j * panelsize+panelsize-1, i * panelsize+panelsize-2);



                    // ctx.arc(panelsize / 2 + j * panelsize  , panelsize / 2 + i * panelsize , panelsize * 0.4, 0, Math.PI * 2,true); //画圈圈
                    // ctx.stroke();
                    ctx.closePath();

                    // if (hahaha[i][j] != 0)
                    //     //ctx.fillRect(i * panelsize, j * panelsize, panelsize, panelsize);
                    //     ctx.fill();
                    // else


                    ctx.beginPath();
                    ctx.fillStyle =ctx.strokeStyle = 'rgba(0,' + Math.floor(255 - 255/lie * j) + ',' +
                        Math.floor(255 - 255/hang * i) + ',0.5)';
                    if(nonono[i+1][j+1]>0)  //选择过程中的标识
                        ctx.fillRect(j * panelsize, i * panelsize, panelsize, panelsize);
                    if(hahaha[i+1][j+1]>0)  //被选中
                        ctx.fillRect(j * panelsize, i * panelsize, panelsize, panelsize);
                    if(cococo[i+1][j+1]==0) {

                        ctx.fillStyle = "#000000";

                        ctx.fillRect(j * panelsize+0.15* panelsize, i * panelsize+0.15* panelsize, panelsize-0.3* panelsize, panelsize-0.3* panelsize);

                        // ctx.arc(panelsize / 2 + j * panelsize, panelsize / 2 + i * panelsize, panelsize * 0.38, 0, Math.PI * 2, true); //画圈圈
                        // ctx.fill();
                    }
                    if(cococo[i+1][j+1]==1) {

                        ctx.fillStyle = "#4caf50";
                        ctx.arc(panelsize / 2 + j * panelsize, panelsize / 2 + i * panelsize, panelsize * 0.38, 0, Math.PI * 2, true); //画圈圈
                        ctx.fill();
                    }
                    if(cococo[i+1][j+1]==2) {

                        ctx.fillStyle = "#008cba";
                        ctx.arc(panelsize / 2 + j * panelsize, panelsize / 2 + i * panelsize, panelsize * 0.38, 0, Math.PI * 2, true); //画圈圈
                        ctx.fill();
                    }
                    if(cococo[i+1][j+1]==3) {

                        ctx.fillStyle = "#b80af4";
                        ctx.arc(panelsize / 2 + j * panelsize, panelsize / 2 + i * panelsize, panelsize * 0.38, 0, Math.PI * 2, true); //画圈圈
                        ctx.fill();
                    }
                    if(cococo[i+1][j+1]==4) {

                        ctx.strokeStyle = "#ff1d2d";
                        ctx.moveTo(j * panelsize,i * panelsize);
                        ctx.lineTo(j * panelsize+ panelsize,i* panelsize+panelsize);
                        ctx.moveTo(j * panelsize,i* panelsize+panelsize);
                        ctx.lineTo(j * panelsize+panelsize,i* panelsize);
                        ctx.stroke();

                       // ctx.arc(panelsize / 2 + j * panelsize, panelsize / 2 + i * panelsize, panelsize * 0.38, 0, Math.PI * 2, true); //画圈圈


                        //ctx.fill();
                    }
                    if(cococo[i+1][j+1]==6) {

                        ctx.fillStyle = 'rgba(55,55,55,0.5)';

                        ctx.fillRect(j * panelsize, i * panelsize, panelsize, panelsize);

                        // ctx.arc(panelsize / 2 + j * panelsize, panelsize / 2 + i * panelsize, panelsize * 0.38, 0, Math.PI * 2, true); //画圈圈
                        // ctx.fill();
                    }

                    ctx.closePath();


                }


                ctx.closePath();

            }

            ctx.restore();







        }


        //--------------------这个函数在于不去绘制任何图形只是操作数据结构而已
        function initcanvaspanel()
        {  //画圈圈和框框

            var oncanvas = document.getElementById('bbb');
            var ctx = oncanvas.getContext('2d');

            ctx.clearRect(0,0,800,600);

            oncanvas.onmouseover = function (ev)
            {  //鼠标进入区域
                console.log("onmouseoverbbb");
            };

            oncanvas.onmouseout =function ()
            {//鼠标移动出区域
                console.log("onmouseoutbbb");
                oncanvas.onmousemove=null;
                // document.onmouseup =null;
            };


            oncanvas.onmousedown=function (ev)  //鼠标按下去
            {
                console.log("onmousedown");
                //鼠标点下去
                //鼠标所在的位置
                //ev.offsetX
                //ev.offsetY
                var oldX = ev.offsetX-0.4*panelsize;
                var oldY = ev.offsetY-0.4*panelsize;
                var balldownX1 = Math.floor(oldX / panelsize);
                var balldownY1 = Math.floor(oldY / panelsize);

                console.log(balldownX1);
                console.log(balldownY1);


                nonono[balldownY1+1][balldownX1+1]=1;


                // hahaha=[];
                for (var a = 1; a <= hang; a++)
                {
                    if (nonono[a][0]>0)  //如果整个行被选中
                    {
                        //console.log("test");
                        for(var b=1;b<=lie;b++)
                        {
                            nonono[a][b]=1;
                        }
                    }

                }
                for (var b = 1; b <= lie; b++)
                {
                    if (nonono[0][b]>0)  //如果整个行被选中
                    {
                        //console.log("test");
                        for(var a=1;a<=hang;a++)
                        {
                            nonono[a][b]=1;
                        }
                    }

                }






                oncanvas.onmousemove=function (ev)   //鼠标按下去后框选
                {
                    console.log("onmousemove");
                    var oldX = ev.offsetX-0.4*panelsize;
                    var oldY = ev.offsetY-0.4*panelsize;


                    //----------------------------------------------矩形框选 任意方向矩形
                    var ballmoveX2 = Math.floor(oldX / panelsize);
                    var ballmoveY2 = Math.floor(oldY / panelsize);



                    nonono[ballmoveY2+1][ballmoveX2+1]=1;
                    console.log(ballmoveY2);
                    console.log(ballmoveX2);



                    var x1=Math.min(balldownX1,ballmoveX2);
                    var x2=Math.max(balldownX1,ballmoveX2);
                    var y1=Math.min(balldownY1,ballmoveY2);
                    var y2=Math.max(balldownY1,ballmoveY2);


                    //-------------------标记数组清空-----------------
                    nonono=[
                        [0,0,0,0,0,0,0,0,0,0,0,0,0],
                        [0,0,0,0,0,0,0,0,0,0,0,0,0],
                        [0,0,0,0,0,0,0,0,0,0,0,0,0],
                        [0,0,0,0,0,0,0,0,0,0,0,0,0],
                        [0,0,0,0,0,0,0,0,0,0,0,0,0],
                        [0,0,0,0,0,0,0,0,0,0,0,0,0],
                        [0,0,0,0,0,0,0,0,0,0,0,0,0],
                        [0,0,0,0,0,0,0,0,0,0,0,0,0],
                        [0,0,0,0,0,0,0,0,0,0,0,0,0]
                    ];

                    //把选中的格子标记在nonono里面

                    for (i = x1; i <= x2; i++)
                        for (j = y1; j <= y2; j++)
                            nonono[j+1][i+1] = 1;


                    for (var a = 1; a <= hang; a++)
                    {
                        if (nonono[a][0]>0)  //如果整个行被选中
                        {
                            console.log("test");
                            for(var b=1;b<=lie;b++)
                            {
                                nonono[a][b]=1;
                            }
                        }

                    }
                    for (var b = 1; b <= lie; b++)
                    {
                        if (nonono[0][b]>0)  //如果整个行被选中
                        {
                            //console.log("test");
                            for(var a=1;a<=hang;a++)
                            {
                                nonono[a][b]=1;
                            }
                        }

                    }

                    refreshpanel();


                }



                oncanvas.onmouseup=function (ev) //松开 有点好玩
                {
                    console.log("onmouseup");
                    oncanvas.onmousemove=null;
                    oncanvas.onmouseup =null;



                    var oldX = ev.offsetX;
                    var oldY = ev.offsetY;


                    //----------------------------------------------矩形框选 任意方向矩形

                    var ballupX2 = Math.floor(oldX / panelsize);
                    var ballupY2 = Math.floor(oldY / panelsize);


                    //如果点击同一个格子，则取消选择


                    // ----判断 如果点击和松开在同一个格子，则取消

                    // if (balldownX1==ballupX2 && balldownY1==ballupY2)
                    //
                    //     if(hahaha[balldownX1][balldownY1]==1)
                    //
                    //         nonono[balldownX1][balldownY1]=hahaha[balldownX1][balldownY1]=0;

                    //放开把nonono放入到hahaha中，并清空nonono
                    //如果按了control就添加 否则就以选中为准
                    if(ev.ctrlKey)
                    {
                        for (var i = 0; i < hang+1; i++) {
                            for (var j = 0; j < lie+1; j++) {
                                if(hahaha[i][j]+nonono[i][j]>=1)
                                    hahaha[i][j] = 1;
                                else
                                    hahaha[i][j]=0;
                                nonono[i][j] = 0;
                            }
                        }
                    }
                    else
                    {
                        for (var i = 0; i < hang+1; i++) {
                            for (var j = 0; j < lie+1; j++) {
                                //if(hahaha[i][j]+nonono[i][j]>=1)
                                hahaha[i][j] = nonono[i][j];
                                // else
                                //     hahaha[i][j]=0;
                                nonono[i][j] = 0;
                            }
                        }
                    }


                   // paneltoscatter();
                    selectpaneltoscatter();

                 //   refreshscatter();
                    refreshpanel();//改变hahaha[]后 重绘


                };


                refreshpanel();  //down函数按下去后重绘

            };


            refreshpanel();


        }




</script>














</body>
</html>