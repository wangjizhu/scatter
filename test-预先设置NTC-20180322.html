<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>ECharts</title>

    <script src="./echarts.js"></script>
    <script src='./ecStataaa.js'></script>
    <!--<script src='./FileSaver.js'></script>-->

    <style>
        canvas { border: 1px solid black; }



        .button_color {
        //background-color: #4CAF50; /* Green */
            border: none;
            color: white;
            padding: 15px 32px;
            text-align: center;
            text-decoration: none;
            /*display: inline-block;*/
            font-size: 16px;
            cursor: pointer;
            /*float: left;*/
        }
        .button0 {
            background-color: #000000;
        }
        .button1 {
            background-color: #4CAF50;
        }
        .button2 {
            background-color: #008CBA;
        }
        .button3 {
            background-color: #b80af4;
        }
        .button4 {
            background-color: #ffffff;
        }
        .button0:hover {
            background-color: #808080;
        }
        .button1:hover {
            background-color: #808080;
        }
        .button2:hover {
            background-color: #808080;
        }
        .button3:hover {
            background-color: #808080;
        }


        .button4{color: black;}
        .button4:hover {
            background-color: #808080;
        }


    </style>



</head>
<body onload="initscatter()">
<!-- 为ECharts准备一个具备大小（宽高）的Dom -->
<div>
    <!--//id=1 2 3 直接用户数组小标 不用判断-->
    <button id="0" class="button_color button0" onclick="setcolorscatter(this)">Black</button>
    <button id="1" class="button_color button1" onclick="setcolorscatter(this)">Green</button>
    <button id="2" class="button_color button2" onclick="setcolorscatter(this)">Blue</button>
    <button id="3" class="button_color button3" onclick="setcolorscatter(this)">red</button>
    <button id="4" class="button_color button4" onclick="setcolorscatter(this)">打叉叉</button>
    <button id="6" class="button_color button4" onclick="setcolorscatter(this)">跑飞了</button>

    <button id="6" onclick="clustering()">聚类</button>
    <button id="7" onclick="yiwanci()">一万次</button>
    <button id="8" onclick="dikaer()">笛卡尔</button>
    <button id="9" onclick="jizuobiao()">极坐标</button>
    <a onclick="exportCSV(this)" download="downlaod.csv" href="#">导出数据</a>


    <!--<button class="button">Button</button>-->
</div>

<div style="float:left">
    <div id="main" style="width: 600px;height:600px;"></div>
    <div style="float:left">
        <input type="range" id="myRange" value ="90" min="50" max="100" step="0.01" oninput="flitter()"/>
    </div>
    <div style="float:left">
        <p id="flitter">90.0%</p>
    </div>

<!--<button oninput="flitter()">flitter</button>-->

    <!--<div style="clear:both">-->

            <!--Xstart: <input type="text" id="x1" value="700"/>-->
            <!--Xend: <input type="text" id="x2" value="800"/>-->
            <!--<button id="7" class="change" onclick="changX()">改变X轴</button>-->
    <!--</div>-->

    <!--<div style="clear:both">-->

    <!--Ystart: <input type="text" id="y1" value="700"/>-->
    <!--Yend: <input type="text" id="y2" value="800"/>-->
    <!--<button id="8" class="change" onclick="changY()">改变Y轴</button>-->
<!--<div>-->
    <!--<form id="list1" method="post" action="">-->
        <!--<p\>五张板子-->
        <!--<input type="radio" name="banzi" value="0">0-->
        <!--<input type="radio" name="banzi" value="1">1-->
        <!--<input type="radio" name="banzi" value="2">2-->
        <!--<input type="radio" name="banzi" value="3">3-->
        <!--<input type="radio" name="banzi" value="4">4-->
    <!--</form>-->

    <!--<form id="list2" method="post" action="">-->
        <!--四个通道<input type="radio" name="tongdao" value="1">00-->
        <!--<input type="radio" name="tongdao" value="1">01-->
        <!--<input type="radio" name="tongdao" value="2">10-->
        <!--<input type="radio" name="tongdao" value="3">11-->
    <!--</form>-->


    <!--<button id="9" onclick="choose()">选择</button>-->


<!--</div>-->

</div>


<div style="float:left">
    <canvas id="bbb" width="800" height="600"></canvas>
</div>

<script type="text/javascript">


//------------------------这里是数据的初始化处理部分 临时使用------------------------------------


function exportCSV (aLink) {
    // 这里可以将后台返回的数据放入csvData，然后将其导出到csv保存

    data=datadikaer;

    var str="Numon384,Well96,SNP,HEX,FAM,result\n";
    for (var a=0;a<data.length;a++)
    {
        var SNP;
        var resultfh;

        switch(data[a][2]) {
            case 0 : resultfh="NTC"; break;
            case 1 : resultfh="YY"; break;
            case 2 : resultfh="XY"; break;
            case 3 : resultfh="XX"; break;
            case 4 : resultfh="Undetermined"; break;
            case 5 : resultfh="Undefined"; break;
            case 6 : resultfh="Empty"; break;


        }


        // if(Math.floor(a/24)%2==0)
        //     SNP=1;
        // else
        //     SNP=2;

        str+=data[a][8]+","+String.fromCharCode(Math.floor(a/12)+65).toString()+(a%12+1).toString()+","+(Math.floor(data[a][8]/24)%2+1).toString()+","+data[a][0]+","+data[a][1]+","+resultfh+"\n";

    }



     str =  encodeURIComponent(str);
    aLink.href = "data:text/csv;charset=utf-8,\ufeff"+str;
}



// -----------------------------这个是吧xy缩放到确定的位置----------

function changX()
{
    var x1=parseInt(document.getElementById("x1").value);
    var x2=parseInt(document.getElementById("x2").value);



    myChart.setOption({
        dataZoom: [{
           // type: 'value',
            xAxisIndex: 0,
            startValue: x1,
            endValue: x2
            //name:'FAM'

             },

            {
            // type: 'value',
            //yAxisIndex: 0,

            //name:'FAM'

        }


        ]
        })

}

function changY() {
    var y1 = parseInt(document.getElementById("y1").value);
    var y2 = parseInt(document.getElementById("y2").value);


    myChart.setOption({
        dataZoom: [
            {
                // type: 'value',
                //xAxisIndex: 0,

                //name:'FAM'

            },

            {
            // type: 'value',
            yAxisIndex: 0,
            startValue: y1,
            endValue: y2
            //name:'FAM'
            }


        ]
    })

}





function flitter() {
        var x = document.getElementById("myRange").value;

        document.getElementById("flitter").innerHTML = x+'%';

        quanlity=x;

        for(var n=0;n<96;n++){

            if (data[n][2]>0&&data[n][2]<5) {

                if (data[n][7] < quanlity / 100)     //判定阈值判断
                {
                    data[n][2] = 4;
                }
                else
                {
                    var maxnum = maxof3(data[n][4], data[n][5], data[n][6]);
                    data[n][2] = maxnum[0]+1;
                }

            }

        }

        refreshscatter();


    }




    var cishu=500;
    var quanlity=0.80;

    var zuobiaoxi=0; //目前选择的状态标记0表示笛卡尔 1表示极坐标


//------------------------一下是两个数组初始化datadikaer指向dikaer数组空间，datajizuobiao指向dikaer数组空间
//-------------------------坐标在初始化时候算死确定不用来回算，后面分组信息在单机按钮后相互转移


        var data=[];
        var datajizuobiao=[];
            var random = function (max){
                return ((Math.random()*max));
            };

       // 将数据装载到数组中
       //  for (var i = 0; i < 5; i++) {
       //      data.push([random(20)+10, random(20)+10,0,0,0,0,0,1]);
       //  };
       //  for (var i = 0; i < 24; i++) {
       //      data.push([random(50)+100, random(20)+10,5,0,0,0,0,1]);
       //  };
       //  for (var i = 0; i < 40; i++) {
       //      var a=random(100)
       //      data.push([random(20)+100, random(20)+100,5,0,0,0,0,1]);
       //  };
       //  for (var i = 0; i < 24; i++) {
       //      data.push([random(20)+10, random(100)+100,5,0,0,0,0,1]);
       //  };
       //  for (var i = 0; i < 3; i++) {
       //      data.push([random(100)+10, random(100)+10,5,0,0,0,0,1]);
       //  };


var datarawseries=
    [

        [[1.269969,1.339057],
            [1.94903,0.99886],
            [1.927103,0.80674],
            [2.046971,0.778146],
            [1.13818,0.998816],
            [1.026542,1.482061],
            [0.902246,1.647187],
            [0.711269,1.623057],
            [0.729351,1.636574],
            [0.945656,1.713345],
            [2.040349,1.06615],
            [2.05617,1.101548],
            [2.239089,1.142602],
            [2.481982,1.009411],
            [1.713518,0.972418],
            [2.252564,0.666272],
            [1.655532,1.175091],
            [1.375696,1.238637],
            [1.120424,1.346575],
            [0.931948,1.364958],
            [0.924532,1.334504],
            [1.234042,1.169535],
            [2.249911,0.615844],
            [2.32301,0.730847],
            [1.377558,1.32429],
            [1.687931,1.193731],
            [2.096879,0.777279],
            [2.105653,0.742145],
            [1.12782,1.266101],
            [1.044714,1.234195],
            [1.020804,1.355672],
            [0.735293,1.26825],
            [0.725605,1.222776],
            [0.977871,1.427],
            [2.113032,0.758775],
            [2.167243,0.742868],
            [1.525459,1.234427],
            [1.152766,1.314383],
            [2.220316,0.681611],
            [2.23381,0.7036],
            [2.441334,0.823932],
            [1.457354,1.186038],
            [1.041407,1.402913],
            [0.899866,1.589532],
            [0.900563,1.604194],
            [1.052219,1.455639],
            [2.222153,0.929827],
            [2.355215,0.862188],
            [1.92938,0.802344],
            [2.02802,0.774722],
            [2.089668,0.763205],
            [2.089901,0.778016],
            [2.07149,0.754729],
            [2.073761,0.781394],
            [0.996181,1.357967],
            [0.790016,1.369565],
            [0.886328,1.399379],
            [0.894928,1.397875],
            [1.905892,0.699259],
            [2.050702,0.700964],
            [2.141565,0.727041],
            [2.189571,0.729159],
            [2.171647,0.694609],
            [2.031225,0.700851],
            [2.230343,0.745164],
            [2.165129,0.735295],
            [0.752156,1.275445],
            [1.000229,1.388276],
            [0.9272,1.484464],
            [2.532203,0.76332],
            [2.026601,0.835741],
            [2.103885,0.8995],
            [1.940115,0.790026],
            [2.078348,0.80767],
            [2.09726,0.757853],
            [2.117508,0.775631],
            [2.143932,0.755138],
            [2.116024,0.80137],
            [0.883884,1.369589],
            [0.860255,1.384086],
            [0.733612,1.31171],
            [0.886292,1.396662],
            [1.916869,0.688326],
            [2.080942,0.684224],
            [2.115279,0.718605],
            [2.270212,0.71433],
            [2.23376,0.730037],
            [1.992014,0.699473],
            [2.261595,0.719243],
            [2.154639,0.724336],
            [0.838413,1.356698],
            [0.839643,1.399256],
            [1.138606,1.422483],
            [1.074073,1.373919],
            [1.947948,0.762479],
            [2.147404,0.767758],
            [2.164009,0.835041],
            [2.08548,0.793578],
            [2.096567,0.743101],
            [2.091037,0.790441],
            [2.026978,0.78715],
            [2.050374,0.815325],
            [0.764974,1.341752],
            [0.85535,1.337104],
            [0.777559,1.536246],
            [0.793061,1.295556],
            [2.086527,0.713177],
            [2.095621,0.692933],
            [2.354221,0.734205],
            [2.275822,0.726289],
            [2.174598,0.730668],
            [2.195076,0.72856],
            [2.142661,0.740165],
            [2.073136,0.727465],
            [0.752978,1.414138],
            [0.840449,1.38834],
            [0.788657,1.589225],
            [0.917879,1.630301],
            [2.084273,0.775318],
            [2.065241,0.822522],
            [2.044383,0.834718],
            [2.05397,0.826047],
            [2.138598,0.788293],
            [2.078224,0.775583],
            [2.029201,0.752399],
            [2.093794,0.784907],
            [0.741274,1.346816],
            [0.895047,1.267272],
            [0.753847,1.470424],
            [2.395453,0.768521],
            [2.169009,0.696446],
            [2.534476,0.65276],
            [2.22171,0.713396],
            [2.298945,0.742036],
            [2.224536,0.751547],
            [2.487571,0.747047],
            [2.207752,0.746167],
            [2.149056,0.75896],
            [0.752006,1.374774],
            [2.445115,0.753488],
            [0.943189,1.486702],
            [2.510351,0.718679],
            [2.113331,0.691173],
            [2.387173,0.800268],
            [1.649038,1.061002],
            [1.599865,1.082698],
            [2.080009,0.831849],
            [2.010038,0.787664],
            [2.201432,0.793561],
            [2.087784,0.791071],
            [0.843075,1.438708],
            [0.834409,1.454012],
            [2.098835,0.783532],
            [2.154698,0.829635],
            [2.240036,0.742085],
            [2.008596,0.714451],
            [1.846374,0.994799],
            [1.805212,1.070801],
            [2.181928,0.738806],
            [2.232037,0.733194],
            [2.30648,0.762531],
            [2.112376,0.76443],
            [0.82405,1.237581],
            [0.888192,1.661679],
            [2.260077,0.794551],
            [2.419343,0.796665],
            [2.105228,0.749317],
            [2.089906,0.799499],
            [1.592307,1.049778],
            [1.6183,1.105015],
            [1.98172,0.795659],
            [1.99635,0.751276],
            [2.154723,0.778614],
            [2.080784,0.792097],
            [0.816705,1.307029],
            [0.793723,1.412409],
            [1.980106,0.800078],
            [2.17584,0.848394],
            [1.960378,0.845553],
            [1.955218,0.728343],
            [1.552025,0.895643],
            [1.774385,1.045786],
            [2.143203,0.761319],
            [2.159089,0.731285],
            [2.205551,0.733558],
            [2.180468,0.734188],
            [0.729153,1.34902],
            [0.806851,1.503197],
            [2.088387,0.805383],
            [2.28645,0.804717],
            [2.052629,0.700029],
            [2.103021,0.772431],
            [2.08343,0.798106],
            [2.173475,0.829168],
            [0.951708,1.404785],
            [0.8323,1.321876],
            [2.228283,0.784506],
            [2.262071,0.756411],
            [2.342928,0.781079],
            [0.971558,1.377936],
            [1.234786,1.439826],
            [0.828944,1.39177],
            [2.177234,0.77954],
            [2.229222,0.779408],
            [2.478574,0.732545],
            [2.287318,0.76568],
            [1.719454,1.053381],
            [0.890814,1.361955],
            [2.362697,0.76392],
            [2.287432,0.715949],
            [2.026664,1.102939],
            [0.875786,1.517122],
            [0.76696,1.436281],
            [2.43785,0.791393],
            [2.440205,0.808166],
            [2.25666,0.818232],
            [2.238217,0.815251],
            [2.080163,0.79505],
            [0.873625,1.302517],
            [0.820668,1.325802],
            [2.14002,0.778561],
            [2.207883,0.768884],
            [0.79545,1.23634],
            [0.803845,1.409249],
            [0.765619,1.33774],
            [0.921786,1.304356],
            [2.085792,0.753792],
            [2.166212,0.735004],
            [0.414065,0.580607],
            [2.249343,0.740772],
            [0.918823,1.311232],
            [0.855486,1.348632],
            [2.312861,0.733864],
            [2.305101,0.720356],
            [0.832181,1.290286],
            [0.815347,1.367191],
            [0.670844,1.455281],
            [0.88845,1.467385],
            [2.260247,0.776567],
            [2.349889,0.800243],
            [2.247942,0.787018],
            [2.081825,0.766219],
            [2.050125,0.767712],
            [1.975069,0.739032],
            [2.207136,0.750236],
            [2.156714,0.760259],
            [0.904431,1.42166],
            [0.747005,1.45807],
            [2.002334,0.810161],
            [2.002886,0.77297],
            [0.841428,1.29142],
            [0.73983,1.234488],
            [2.23345,0.875191],
            [2.208089,0.741606],
            [2.17223,0.672862],
            [2.051216,0.711014],
            [2.359989,0.731615],
            [2.190871,0.689489],
            [0.828838,1.403943],
            [0.748598,1.423256],
            [2.106166,0.764973],
            [2.423987,0.787767],
            [0.757207,1.318208],
            [0.737398,1.343031],
            [1.981781,0.778112],
            [2.025167,0.760209],
            [1.979933,0.724483],
            [1.949547,0.658705],
            [2.141783,0.729517],
            [2.151414,0.749883],
            [0.773051,1.408705],
            [0.754511,1.436067],
            [1.847568,0.798793],
            [1.981584,0.756077],
            [0.755829,1.240496],
            [0.723502,1.231169],
            [2.061915,3.456357],
            [2.182657,0.75616],
            [2.179959,0.700959],
            [2.10756,0.73967],
            [2.326877,0.72697],
            [2.218234,0.707428],
            [0.728626,1.382261],
            [0.730191,1.441897],
            [2.041924,0.734184],
            [2.218906,0.730329],
            [0.691961,1.271522],
            [2.379984,0.88334],
            [2.056318,0.795198],
            [2.151017,0.755106],
            [2.077815,0.757523],
            [2.075653,0.741167],
            [2.196614,0.733291],
            [2.207622,0.762763],
            [0.80193,1.490695],
            [1.249641,1.368284],
            [1.529376,1.031658],
            [1.646698,1.062246],
            [2.123053,0.737975],
            [2.105923,0.801111],
            [2.4335,0.776239],
            [2.305612,0.762696],
            [2.223309,0.732004],
            [2.104766,0.713905],
            [2.346025,0.72581],
            [2.329186,0.738247],
            [0.812598,1.462672],
            [1.133569,1.377209],
            [1.639309,1.026785],
            [1.718969,1.027081],
            [2.18408,0.698838],
            [2.17829,0.824146],
            [2.092,0.807128],
            [2.135893,0.780275],
            [2.045389,0.734677],
            [2.07231,0.723502],
            [2.160049,0.747625],
            [2.225027,0.776582],
            [0.771674,1.438228],
            [1.144543,1.407691],
            [1.343619,0.983708],
            [1.626894,1.050683],
            [1.954887,0.685753],
            [2.200273,0.79885],
            [2.197136,0.753355],
            [2.363093,0.775554],
            [2.141213,0.709744],
            [2.113057,0.714504],
            [2.253869,0.72353],
            [2.268346,0.759621],
            [0.754608,1.436784],
            [1.42215,1.380731],
            [1.58824,1.07076],
            [1.667122,0.98771],
            [2.138128,0.675461],
            [2.264465,0.761539],
            [3.429764,0.83185],
            [2.102983,0.795103],
            [2.15054,0.780439],
            [2.203799,0.753553],
            [2.354163,0.803784],
            [1.950947,0.782786],
            [1.740663,1.44884],
            [0.749642,1.4315],
            [0.789734,1.445562],
            [0.82263,1.322663],
            [2.038019,0.799628],
            [1.958498,0.740365],
            [5.56074,0.786186],
            [2.300359,0.767304],
            [2.361104,0.752207],
            [2.315536,0.730208],
            [2.568461,0.694984],
            [2.032266,0.771909],
            [0.732545,1.526281],
            [0.761986,1.446319],
            [0.821469,1.496392],
            [0.869757,1.35662],
            [6.307251,0.75168],
            [2.211634,0.818718],
            [2.043535,0.872732],
            [2.068672,0.81028],
            [2.172389,0.821717],
            [2.28038,0.793719],
            [2.441736,0.727245],
            [2.068082,0.765918],
            [0.697554,1.434614],
            [0.720254,1.504433],
            [0.669792,1.422931],
            [0.814784,1.369906],
            [1.942849,0.741244],
            [2.005402,0.738227],
            [2.206385,0.847794],
            [2.246563,0.793213],
            [2.233741,0.771985],
            [2.277429,0.728455],
            [2.493557,0.704359],
            [2.035797,0.765549],
            [0.658572,1.502491],
            [0.749331,1.51531],
            [0.687538,1.475955],
            [0.911949,1.405972],
            [2.215702,0.734154],
            [2.039498,0.749516]],


        [[2.467127,1.59676],
            [2.363353,1.643837],
            [2.480125,1.311024],
            [2.49774,1.338007],
            [1.332546,1.825596],
            [1.57465,1.877883],
            [1.198999,1.909369],
            [0.963496,1.907226],
            [2.666424,1.262109],
            [2.690696,1.497785],
            [2.676989,1.354784],
            [2.686033,1.445352],
            [1.552534,1.888979],
            [1.440009,1.965981],
            [2.710515,1.43218],
            [2.6923,1.341821],
            [1.688282,1.96705],
            [1.753,1.967021],
            [1.31766,1.926269],
            [1.001393,1.958355],
            [2.736317,1.338942],
            [2.816162,1.50287],
            [2.799928,1.411794],
            [2.868805,1.701702],
            [2.09405,1.905026],
            [1.660856,1.844907],
            [2.621288,1.471495],
            [2.622424,1.495833],
            [1.565179,1.911033],
            [1.353074,1.874882],
            [1.481414,1.930066],
            [2.770348,1.567754],
            [2.752072,1.372124],
            [2.758167,1.632069],
            [2.769038,1.479003],
            [2.766022,1.583688],
            [2.060696,1.971913],
            [1.628634,2.002835],
            [2.82717,1.436695],
            [2.781444,1.530182],
            [2.822629,1.720906],
            [1.887809,1.992909],
            [2.68975,1.459473],
            [1.209645,1.974068],
            [2.760347,1.424486],
            [2.825812,1.51827],
            [2.811106,1.394725],
            [2.855819,1.607032],
            [2.521752,1.285168],
            [2.579443,1.247297],
            [2.583314,1.431806],
            [2.623356,1.446355],
            [2.611898,1.433189],
            [2.632097,1.523387],
            [1.866096,1.967771],
            [1.804413,1.973464],
            [1.735217,2.008256],
            [1.685755,2.033866],
            [2.740846,1.39486],
            [2.793694,1.509683],
            [2.804087,1.359727],
            [2.78129,1.312041],
            [2.795568,1.462144],
            [2.730433,1.26297],
            [2.789427,1.458601],
            [2.321997,1.853148],
            [1.915376,1.91774],
            [1.852565,1.96632],
            [1.916221,1.978159],
            [1.776153,1.926852],
            [2.756636,1.030977],
            [2.874137,1.624009],
            [2.575736,1.294368],
            [2.635212,1.312338],
            [2.612771,1.455966],
            [2.650009,1.449245],
            [2.647138,1.482423],
            [2.3615,1.748342],
            [1.849246,1.894894],
            [2.708962,1.693793],
            [1.737325,1.966842],
            [1.656479,1.947489],
            [2.725109,1.397137],
            [2.789002,1.512461],
            [2.814716,1.484502],
            [2.808106,1.310941],
            [2.803258,1.444551],
            [2.745626,1.292153],
            [2.810932,1.43683],
            [2.806036,1.589762],
            [1.817467,1.94599],
            [1.842236,1.962112],
            [1.797856,1.995615],
            [1.72901,1.934718],
            [2.811461,1.28364],
            [2.886786,1.533893],
            [2.530936,1.424275],
            [2.577197,1.422256],
            [2.59624,1.421462],
            [2.624888,1.246353],
            [2.657512,1.343137],
            [2.630463,1.414521],
            [1.337463,1.856228],
            [1.745665,1.914203],
            [1.255533,1.994076],
            [1.435255,1.913899],
            [2.750198,1.370996],
            [2.791864,1.433935],
            [2.835464,1.589727],
            [2.820977,1.482587],
            [2.78795,1.428249],
            [2.829061,1.282845],
            [2.804652,1.323898],
            [2.292678,1.819527],
            [1.357451,1.984748],
            [1.756134,2.012095],
            [1.308787,2.062801],
            [1.489222,1.993227],
            [2.829791,1.100925],
            [2.891248,1.498411],
            [2.538386,1.527386],
            [2.565396,1.497475],
            [2.62278,1.430894],
            [2.619369,1.265468],
            [2.642604,1.337957],
            [2.219822,1.551657],
            [1.462967,1.884212],
            [2.701603,1.687567],
            [1.308091,1.976233],
            [1.396474,1.913041],
            [2.746013,1.328454],
            [2.782183,1.425516],
            [2.831844,1.557433],
            [2.785553,1.51162],
            [2.771894,1.456935],
            [2.828168,1.437375],
            [2.818269,1.363501],
            [2.738505,1.406404],
            [1.368821,2.087539],
            [1.763769,1.993686],
            [1.417819,2.060069],
            [1.332053,1.931352],
            [2.8052,1.135604],
            [2.878416,1.421421],
            [2.258583,1.729273],
            [2.147624,1.718726],
            [2.591653,1.146114],
            [2.619407,1.080421],
            [2.658069,1.285823],
            [2.624262,1.332947],
            [1.390219,1.906706],
            [1.461046,1.950019],
            [2.699952,1.448094],
            [2.748509,1.651121],
            [2.765051,1.331953],
            [2.786499,1.345218],
            [2.581554,1.832081],
            [2.368184,1.753403],
            [2.810258,1.059519],
            [2.820975,1.053291],
            [2.792437,1.34101],
            [1.846565,1.9107],
            [1.363761,1.92006],
            [1.491175,1.997642],
            [2.778957,1.525093],
            [2.868344,1.639598],
            [2.880161,1.144178],
            [2.902926,1.423143],
            [2.342088,1.764665],
            [2.230554,1.708444],
            [2.6032,1.166374],
            [2.619144,1.132905],
            [2.640053,1.262234],
            [2.128316,1.664922],
            [1.438489,1.861976],
            [2.706348,1.67053],
            [2.694175,1.446049],
            [2.754159,1.635992],
            [2.767502,1.445803],
            [2.75024,1.422591],
            [2.547292,1.833793],
            [2.395206,1.768422],
            [2.813529,1.075393],
            [2.819378,1.059356],
            [2.794313,1.424486],
            [2.750237,1.419325],
            [2.662302,1.477923],
            [1.476695,1.961174],
            [2.764309,1.475831],
            [2.846512,1.55528],
            [2.856598,1.209368],
            [2.881851,1.421649],
            [2.594504,1.588153],
            [2.591416,1.570404],
            [2.603731,1.682072],
            [2.650669,1.744824],
            [2.687382,1.577548],
            [2.653298,1.462493],
            [1.399322,1.878959],
            [1.59601,1.936636],
            [1.093538,1.972692],
            [1.527686,1.965275],
            [2.747582,1.465199],
            [2.769293,1.543803],
            [2.810616,1.638264],
            [2.800702,1.630005],
            [2.832885,1.743476],
            [2.806091,1.780677],
            [2.848641,1.774262],
            [2.092254,1.845294],
            [1.442509,1.91006],
            [1.534314,1.978469],
            [1.128916,1.984366],
            [1.565801,1.972865],
            [2.875374,1.561092],
            [2.914175,1.583301],
            [2.564643,1.530919],
            [2.640188,1.587851],
            [2.603961,1.683242],
            [2.581376,1.740486],
            [2.68373,1.483863],
            [2.127249,1.660843],
            [1.401165,1.881735],
            [2.685035,1.712648],
            [1.055756,1.988392],
            [2.784894,1.680093],
            [2.797051,1.702311],
            [2.748525,1.536232],
            [2.815458,1.630739],
            [2.828044,1.550055],
            [2.883517,1.754264],
            [2.742827,1.819678],
            [2.819979,1.51389],
            [2.816866,1.686852],
            [1.050972,1.939895],
            [1.538603,1.872292],
            [1.161166,1.944642],
            [1.53434,1.839957],
            [2.838498,1.528604],
            [2.87287,1.556422],
            [2.536496,1.476476],
            [2.598615,1.355274],
            [2.643561,1.122459],
            [2.659168,1.184104],
            [2.68616,1.39227],
            [2.648964,1.403933],
            [1.235651,1.921304],
            [1.410165,1.931844],
            [2.774134,1.812132],
            [2.675583,1.369908],
            [1.312794,1.937837],
            [1.29668,1.903541],
            [2.830428,1.692148],
            [2.830691,1.495434],
            [2.860001,0.959293],
            [2.839475,1.114218],
            [2.802173,1.445897],
            [2.114303,1.797405],
            [1.165719,1.919101],
            [1.410036,1.945658],
            [2.768328,1.316254],
            [2.896091,1.60631],
            [1.246071,1.913579],
            [1.410896,2.03169],
            [2.594483,1.566344],
            [2.617771,1.415453],
            [2.657083,1.124132],
            [2.680695,1.120834],
            [2.684142,1.42158],
            [1.919251,1.665972],
            [1.288764,1.924394],
            [2.718699,1.669276],
            [2.727902,1.474124],
            [2.722741,1.436447],
            [1.412336,1.938223],
            [1.220406,1.886446],
            [2.796398,1.630544],
            [2.827697,1.429098],
            [2.83432,1.071569],
            [2.839932,1.116477],
            [2.815759,1.467588],
            [2.736904,1.527637],
            [2.660263,1.451569],
            [1.409098,1.916012],
            [2.792472,1.403755],
            [2.819564,1.479675],
            [1.293789,2.02212],
            [1.064129,1.967476],
            [2.602655,1.597893],
            [2.663012,1.538523],
            [2.654613,1.469232],
            [2.702187,1.458341],
            [2.713526,1.519272],
            [2.677977,1.632377],
            [1.350015,1.91908],
            [1.903253,1.936842],
            [2.291133,1.734145],
            [2.283617,1.774282],
            [2.742996,1.51993],
            [2.77098,1.653236],
            [2.834728,1.721467],
            [2.843031,1.630843],
            [2.812526,1.440926],
            [2.813809,1.368298],
            [2.832498,1.54772],
            [2.531327,1.848897],
            [1.602294,1.992225],
            [1.941394,1.982714],
            [2.387074,1.72989],
            [2.521681,1.877001],
            [0,0],
            [2.896526,1.774126],
            [2.629027,1.631046],
            [2.672199,1.586711],
            [2.656211,1.451658],
            [2.691293,1.432035],
            [2.715065,1.473307],
            [2.482212,1.705796],
            [1.359049,1.920928],
            [2.769166,1.671779],
            [2.282237,1.761224],
            [2.417473,1.822654],
            [2.76154,1.498934],
            [2.812292,1.620984],
            [2.829964,1.709252],
            [2.830253,1.648062],
            [2.814513,1.44648],
            [2.819005,1.407831],
            [2.846918,1.551952],
            [2.790692,1.581608],
            [2.21697,1.698771],
            [1.976929,1.966554],
            [2.258574,1.737843],
            [2.428477,1.773694],
            [2.886274,1.503449],
            [2.916915,1.697405],
            [2.578756,1.6686],
            [2.692072,1.57343],
            [2.665997,1.496698],
            [2.723615,1.574577],
            [2.748691,1.636944],
            [2.696241,1.306518],
            [2.774884,1.701718],
            [1.443073,1.940203],
            [1.30657,1.992703],
            [1.376918,1.952026],
            [2.740994,1.422431],
            [2.802858,1.524864],
            [2.89025,1.656443],
            [2.825141,1.600493],
            [2.858953,1.550466],
            [2.862092,1.625259],
            [2.908254,1.712914],
            [2.039441,1.78929],
            [1.031729,1.999086],
            [1.491937,1.990276],
            [1.359908,1.991288],
            [1.701208,1.956719],
            [2.876132,1.616279],
            [2.886328,1.531399],
            [2.575795,1.57949],
            [2.631717,1.542834],
            [2.665657,1.492067],
            [2.685557,1.552851],
            [2.785602,1.560775],
            [2.897604,1.488801],
            [2.863743,1.666451],
            [2.825299,1.733363],
            [1.376649,2.010229],
            [1.484014,1.982647],
            [2.766886,1.448428],
            [2.744465,1.144581],
            [2.855897,1.707701],
            [2.846542,1.585161],
            [2.854093,1.563],
            [2.881545,1.632639],
            [2.950388,1.68397],
            [2.813072,1.478762],
            [1.290723,1.979828],
            [1.403195,1.975091],
            [1.267296,1.949212],
            [1.682469,1.960802],
            [2.886349,1.51585],
            [0.633229,1.57056]]

    ];


var fanyingban=1;


var weizhi1=0;
var weizhi2=0;

       // var dataraw=datarawseries[0];


        data=[];
        for (var a=0;a<datarawseries[fanyingban].length;a++)
        {
            if((Math.floor(a/24))%2==weizhi1&&(a%24)%2==weizhi2)
            {


                data.push([datarawseries[fanyingban][a][0], datarawseries[fanyingban][a][1], 5, 0, 0, 0, 0, 1, a]); //5是灰色的还没有聚类状态




            }





            

        }




        // for ( i = 0; i < 4; i++) {
        //     data.push([random(990), random(990),5,0,0,0,0,1,0]);
        // };

        var datadikaer =data;       //datadikaer初始化

        for (var i=0;i<datadikaer.length;i++)    //datajizuobiao初始化
        {
            r=Math.log10((Math.sqrt(datadikaer[i][0]*datadikaer[i][0]+datadikaer[i][1]*datadikaer[i][1])));
            therta=Math.atan(datadikaer[i][1]/datadikaer[i][0]);

            datajizuobiao.push([r,therta,datadikaer[i][2],datadikaer[i][3],datadikaer[i][4],datadikaer[i][5],datadikaer[i][6],datadikaer[i][7]]);

        }



        function jizuobiao()
        {
            if (zuobiaoxi==0)
            {
                zuobiaoxi=1;

                selected=[];  //选择清空

                for (var i = 0; i < datadikaer.length; i++) {
                    for (var j = 2; j < 9; j++)

                        datajizuobiao[i][j] = datadikaer[i][j];

                }

                data = datajizuobiao;      //data指向极坐标

                refreshscatter();
            }


        }

        function dikaer()
        {
            if(zuobiaoxi==1) {

        zuobiaoxi=0;
                selected=[];  //选择清空
                for (var i = 0; i < datadikaer.length; i++) {
                    for (var j = 2; j < 9; j++)

                        datadikaer[i][j] = datajizuobiao[i][j];

                }

                data = datadikaer;   //data指向笛卡尔

                refreshscatter();
            }
        }











        // 基于准备好的dom，初始化echarts实例

        // var data = [];//数据区域缩放组件
        var fenzu=[[],[],[],[]];
        var zhuadaode=[[],[],[],[]];

        var myChart = echarts.init(document.getElementById('main'));

        // function savepic()
        // {
        //     //  var img = new Image();
        //     varaaa = myChart.getDataURL({
        //         type:'jpeg',
        //         pixelRatio: 1,
        //         //backgroundColor: '#fff'
        //         excludeComponents: ['toolbox']
        //     });



         //   }






        var selectchange =1;
        var deepcopy=[];


        function maxof3 (a,b,c)
        {
            var max=a,num=0;
            if (max<b) {
                max = b;
                num=1;
            }
            if (max<c) {
                max = c;
                num=2;
            }


            return [num,max]


        }
    //------------------------聚类一万次---------------------------


        function yiwanci()
    {



//清空
        for(var n=0;n<96;n++){


            data[n][3]=data[n][4]=data[n][5]=data[n][6]=data[n][7]=0;
           //黑色

        }




        for(var i=0;i<cishu;i++)
        {



            clustering();

            for(var n=0;n<96;n++){

             //   if(data[n][2]>0&&data[n][2]<5)
                data[n][data[n][2]+3]++;

            }

        }


         for(var n=0;n<96;n++){
        //


             if(data[n][2]>0) {

                 var maxnum = maxof3(data[n][4], data[n][5], data[n][6]);
                 data[n][2] = maxnum[0] + 1;
                 data[n][7] = maxnum[1] / cishu;

                 if (data[n][7] < quanlity)     //判定阈值判断
                     data[n][2] = 4;
             }



        }





        flitter();

        //refreshscatter();


    }






        var result;
        var ordercentroids=[];
        var nnn=0;

//--------------------聚类!!!!!!!!!!!!!!!!!!!!!!!!!-3类----------------------------------------

        function clustering() {

            var count = 0;

            console.log('clustering');
            var clusterNumber = 3;
            var dataclustering=[];//清空


            //采集需要聚类的点放入dataclustering

            // if(zuobiaoxi==0)
            // {
            //     data=datadikaer;
            //
            // }
            // else
            //     if(zuobiaoxi==1)
            //     {
            //         data=datajizuobiao
            //
            //     }
            //


            for (var i=0;i<data.length;i++)
            {
                if(data[i][2]!=0&&data[i][2]!=4&&data[i][2]!=6)   //NTC和叉叉和跑飞不参与聚类
                    dataclustering.push([data[i][0]*1000,data[i][1]*1000,i]); //放大一千倍放进去聚类
            }



//console.log("stop");

            result = ecStat.clustering.hierarchicalKMeans(dataclustering, clusterNumber, false);

//有时候分出来不是四个组很奇怪。


            // for (var a = 0; a < result.centroids.length; a++) {
            //     if (result.centroids[a].length > 0)
            //         count++;
            //
            // }

            // if (count<4)
            //     n++;

            //console.log(count);

            // if (count<3)    //变态的是 测试了很久很久 这个kmean聚类返回的结果可能不是4类 我也是醉了 小于3重来
            // {
            //     clustering();
            //
            // }

            //----------------------------一下才是3组的处理内容
//             else
//             {
//
//
                ordercentroids = [
                    [result.centroids[0][1]/result.centroids[0][0],0],
                    [result.centroids[1][1]/result.centroids[1][0],1],
                    [result.centroids[2][1]/result.centroids[2][0],2]
                  //  [result.centroids[3][0], result.centroids[3][1]]

                ];  //复制出来加一位



                //
                //=---------------------排序

                ordercentroids.sort(function (a, b) {
                    return b[0]-a[0];
                });                            //按照x坐标排序 序号记录进入第四位


                for (var i = 0; i < ordercentroids.length; i++)  //加一位 插入原始序号

                {
                    ordercentroids[i].push(i);  //排序后序号

                }
//
//
                ordercentroids.sort(function (a, b) {
                    return a[1]-b[1];
                });                                              //在排回去





//                 if (ordercentroids[0][1] > ordercentroids[1][1]) {
//                     ordercentroids[0][3] = 1;
//                     ordercentroids[1][3] = 0;
//
//                 }
//
//
//                 if (ordercentroids[2][1] > ordercentroids[3][1]) {
//                     ordercentroids[2][3] = 3;
//                     ordercentroids[3][3] = 2;
//
//                 }
//
// //-----------------以下这个循环不是人类可以理解的 如果正确了 那么分组将按照顺序赋值给原始数据的分组项
//                 //-----------------如果错了 我也想不出来怎么调试了 但是不幸的是 他对了
//
//
//
//
//                 for (var i = 0; i < 96; i++) {
//
//                     //         console.log(result.clusterAssment[i][0]);
//
//                     //        data[i][2]=result.clusterAssment[i][0];
//
//
//                     for (var n = 0; n < ordercentroids.length; n++) {
//                         if (result.clusterAssment[i][0] === ordercentroids[n][2]) {
//                             data[i][2] = ordercentroids[n][3]
//                         }
//
//                     }
//
//                 }

//-----------------------------------------------------------------------------
//                else

            for (var n = 0; n < dataclustering.length; n++)                   //逆天的操作啊
            {
                data[dataclustering[n][2]][2]=ordercentroids[result.clusterAssment[n][0]][2]+1;   //分组的颜色直接染给对应的data

            }


                colorscattortopanel();


                refreshscatter();
                refreshpanel();
             //   console.log(nnn++);





        }

        function initscatter()
        {

            //构造随机数
            // var random = function (max){
            //     return ((Math.random()*max));
            // };

            //将数据装载到数组中
            // for (var i = 0; i < 25; i++) {
            //     data.push([random(99), random(99),0]);
            // };
            //
            // for ( i = 25; i < 50; i++) {
            //     data.push([random(99), random(99),1]);
            // };
            //
            // for ( i = 50; i < 75; i++) {
            //     data.push([random(99), random(99),2]);
            // };
            //
            // for ( i = 75; i < 100; i++) {
            //     data.push([random(99), random(99),3]);
            // };

            refreshscatter();


            initcanvaspanel();

        }

        function refreshscatter(){

//console.log('refresh');
            //myChart.clear();
                  //0  1  2  3  4   5   6
                  //b  g  b  r  x   n   feile
            fenzu=[[],[],[], [],[],[], []];

           // var select=[];

            for (var i = 0; i < 96; i++){
                fenzu[data[i][2]].push([data[i][0],data[i][1],i]);  //i表示在原数组中的位置
            }




            option = {

                tooltip : {
                    // padding: 10,
                    trigger: 'item',
                    //trigger: 'axis',
                    axisPointer: {
                        type: 'cross'

                    },
                    formatter: '{b}',
                },

                toolbox: {
                    left: 'right',
                    itemSize: 25,
                    top: 5,
                    feature: {
                        myTool1: {
                            show: true,
                            title: '保存图片',
                            icon: 'image://http://echarts.baidu.com/images/favicon.png',
                            //onclick: savepic()


                        },

                        // brush:{
                        //     type: 'rect',
                        //
                        // },
                        //
                        // brush:{
                        //     type: 'polygon',
                        //
                        // },

                        dataZoom: {

                        },



                        //
                        //
                        // myTool2: {
                        //     show: true,
                        //     title: '设置Y轴',
                        //     icon: 'image://http://echarts.baidu.com/images/favicon.png',
                        //     onclick: function () {
                        //         alert('myToolHandler2')
                        //     }
                        //
                        // },


                        restore: {},




                    },

                },



                brush:
                    {
                        toolbox:['rect','polygon','clear'],

                        brushType: 'rect',


                        romoveOnClick:'signle'    //单击空白处清空选择
                    },


                xAxis: {
                    type: 'value',
                    scale: true,
                    min: function(value) {
                        return value.min-(value.max-value.min)*0.1 ;
                    },
                   max: function(value) {
                       return value.max+(value.max-value.min)*0.1 ;
                   },
                    name:'HEX',
                    nameLocation: 'center',
                    nameGap: 20,
                    nameTextStyle: {



                        fontSize: 18

                        // verticalAlign: ...,
                        // lineHeight: ...,

                    }
                }
                ,


                yAxis:
                    {
                        type: 'value',
                        scale: true,
                        min: function(value) {
                            return value.min-(value.max-value.min)*0.1 ;
                        },
                        max: function(value) {
                            return value.max+(value.max-value.min)*0.1;
                        },
                        name:'FAM',
                        nameLocation: 'center',
                        nameGap: 20,
                        nameTextStyle: {


                            fontSize: 18,

                            // verticalAlign: ...,
                            // lineHeight: ...,

                        }
                    }
                ,


                dataZoom: [
                    // 这个dataZoom组件，也控制y轴。

                    {
                        type: 'slider',
                        show: true,
                        xAxisIndex: 0,
                         //start: 0,
                         //end: 110
                    },


                    {   // 这个dataZoom组件，也控制x轴。
                        type: 'inside', // 这个 dataZoom 组件是 inside 型 dataZoom 组件
                        xAxisIndex: 0,
                        filterMode: 'empty',
                         // start: 10,      // 左边在 10% 的位置。
                         // end: 110         // 右边在 60% 的位置。
                    },

                    {
                        type: 'slider',
                        show: true,
                        yAxisIndex: 0,
                        // start: 1,
                        // end: 35
                    },


                    {
                        type: 'inside',
                        yAxisIndex: 0,
                        filterMode: 'empty',
                         // start: 10,
                         // end: 110
                    }


                ],


                series: [

                    {
                        animation: false,
                        name: 'black',
                        type: 'scatter',
                        symbolSize: 10,
                        z:'0',

                        data: fenzu[0],
                        itemStyle: {
                            color: '#000000'
                        },
                        symbol:'rect',

                    },


                    {
                        animation: false,
                        name:'green',
                        type: 'scatter',
                        symbolSize: 10,
                        z:'0',

                        data: fenzu[1],


                        itemStyle: {
                            color: '#4caf50'
                        }


                    },

                    {
                        animation: false,
                        name: 'blue',
                        type: 'scatter',
                        symbolSize: 10,
                        z:'0',

                        data: fenzu[2],


                        itemStyle: {
                            color: '#008cba'
                        },

                     //   symbol:'rect',

                    },

                    {
                        animation: false,
                        name:'red',
                        type: 'scatter',
                        symbolSize: 10,
                        z:'0',

                        data: fenzu[3],


                        itemStyle: {
                            color: '#b80af4'
                        },
                    //    symbol: 'triangle'


                    },


                    {
                        animation: false,
                        name: 'chacha',
                        type: 'scatter',
                        symbolSize: 10,
                        z: '0',

                        data: fenzu[4],


                        itemStyle: {
                            color: '#ff1736'
                        },

                        symbol: 'triangle'


                    },

                    {
                        animation: false,
                        name: 'none',
                        type: 'scatter',
                        symbolSize: 10,
                        z: '0',

                        data: fenzu[5],


                        itemStyle: {
                            color: '#636363'
                        },

                   //     symbol: 'triangle'


                    },


                    {
                        animation: false,
                        name: 'none',
                        type: 'scatter',
                        symbolSize: 10,
                        z: '0',

                        data: fenzu[6],


                        itemStyle: {
                            color: '#dadada'
                        },

                        //     symbol: 'triangle'


                    },



                    {
                        animation: false,
                        name: 'select',
                        type: 'scatter',
                        symbolSize: 20,
                        z: '0',

                        data: selected,


                        itemStyle: {
                            color: '#19f8ff',

                            opacity: 0.6


                        },

                       //symbol: 'rect'



                    }


                ]
            };



            // 使用刚指定的配置项和数据显示图表。
            myChart.setOption(option);


        }



myChart.on('brush', function ()          //这个事件用来出发清除panel选框
{


    hahaha=[
        [0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0]


    ];







});




        myChart.on('brushSelected', function (params) {
            //var brushComponent = params.batch[0];

            //var sum = 0; // 统计选中项的数据值的和
           // var xuhao;


            selectchange=1;
            zhuadaode=params.batch[0];
            deepcopy=[];


          //  selected=[];
   //         refreshscatter();


            console.log('hahaha');
            for (var sIdx = 0; sIdx < zhuadaode.selected.length-1; sIdx++)   //减一的目的是吧select的序列减去
            {
                // 对于每个 series：
                var dataIndices = zhuadaode.selected[sIdx].dataIndex;
                //
                for (var i = 0; i < dataIndices.length; i++) {
                    var dataIndex = dataIndices[i];
                    xuhao=fenzu[sIdx][dataIndex][2];
                    console.log(xuhao);
                    deepcopy.push(xuhao);
                }
            }


            // for (i = 0; i < zhuadaode.length; i++)
            //     console.log(zhuadaode[i]); // 显示抓到的数组下标//


            selectscattortopanel();





        });



        //--------------------------------------点击红色的函数-----------------------------------
        function setcolorscatter(obj)
        {

            var num=obj.id;

            console.log(num);


            //去跟新到每个点序列里面



          //  selectchange=0;   //!!!!!!!!


            //---------------------scatter的选择结果被染色-------------------


            for (var i=0;i<deepcopy.length;i++) {
                var a=deepcopy[i];
                data[a][2]=parseInt(num);
                console.log(deepcopy[i]);
                //cococo也染色
                cococo[parseInt(a / lie)+1][a % lie+1] = parseInt(num); //点击后 颜色直接过去
            }

            //---------------------------panel的选择结果也需要被染色------------------


            //
            // for (var j=0;j<selected.length;j++) {
            //     data[selected[j][2]][2]=parseInt(num);
            //
            //
            // }





            refreshscatter();

             refreshpanel();

        }


function colorscattortopanel() {

    cococo = [
        [9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9],
        [9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9],
        [9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9],
        [9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9],
        [9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9],
        [9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9],
        [9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9],
        [9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9],
        [9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9]

    ];//面板标记颜色清空


    for (var a = 0; a < data.length; a++) {
        {

            cococo[parseInt(a / lie) + 1][a % lie + 1] = data[a][2];

        }


    }

}

function selectscattortopanel() {

    // hahaha = [
    //     [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    //     [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    //     [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    //     [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    //     [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    //     [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    //     [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    //     [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    //     [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
    // ];  //panel先清空


    for (var i = 0; i < deepcopy.length; i++) {
        {
            var a = deepcopy[i];
            hahaha[parseInt(a / lie) + 1][a % lie + 1] = 1;

        }


    }


    refreshpanel();


}


var selected=[]; //这个全局数组标志


function selectpaneltoscatter() {


//先要清空sctter选区 ！！！！！

    selected=[];


    for (var i = 0; i < hang; i++)
    {
        for (var j = 0; j < lie; j++)
        {
            if(hahaha[i+1][j+1]==1)
            {


                selected.push([data[lie * i + j][0],data[lie * i + j][1],lie * i + j]);
                console.log(lie * i + j);

            }
        }

    }

    refreshscatter();

}


var panelsize=55; //panel棋盘边长可调节
var hang=8,lie=12;  //棋盘行列数 可调节
var hahaha=[
    [0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0]


];//panel被选中数组
var nonono=[
    [0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0]

];//鼠标移动时候被选中临时数组 加一个头标记整个行列选中
var cococo=[
    [9,9,9,9,9,9,9,9,9,9,9,9,9],
    [9,9,9,9,9,9,9,9,9,9,9,9,9],
    [9,9,9,9,9,9,9,9,9,9,9,9,9],
    [9,9,9,9,9,9,9,9,9,9,9,9,9],
    [9,9,9,9,9,9,9,9,9,9,9,9,9],
    [9,9,9,9,9,9,9,9,9,9,9,9,9],
    [9,9,9,9,9,9,9,9,9,9,9,9,9],
    [9,9,9,9,9,9,9,9,9,9,9,9,9],
    [9,9,9,9,9,9,9,9,9,9,9,9,9]

];//面板标记颜色



        function refreshpanel()   //obj是文档元素canvas传递过来 增加效率
        {  //画圈圈和框框

            var oncanvas = document.getElementById('bbb');
            var ctx = oncanvas.getContext('2d');


            ctx.clearRect(0,0,1000,1000);   //这里应该是获取画布的长和宽

        //----------------------------画边框

            for (var i = 1; i <= hang; i++)
            {
                ctx.beginPath();
                ctx.lineWidth=2;
                ctx.strokeRect(0, (i-1) * panelsize+0.4*panelsize, 0.4*panelsize, panelsize);


                ctx.font ='18px 微软雅黑 bold';
                ctx.fillStyle = '#000000';
                var Ax=String.fromCharCode(64+i);

                ctx.textAlign="center";

                ctx.fillText(Ax ,0.2*panelsize, i * panelsize);



                if (hahaha[i][0]>0 || nonono[i][0]>0)  //如果整个行被选中
                {


                   // console.log(i);
                    ctx.fillStyle =ctx.strokeStyle = 'rgba(55,55,55,0.5)';

                    ctx.fillRect(0, (i-1) * panelsize+0.4*panelsize, 0.4*panelsize, panelsize); //表头

                }

                ctx.closePath();

            }


            for (var j = 1; j <= lie; j++)
            {


                ctx.beginPath();
                ctx.lineWidth=2;
                ctx.strokeRect((j-1) * panelsize+0.4*panelsize, 0, panelsize, 0.4*panelsize);

                ctx.font ='18px 微软雅黑 bold';
                ctx.fillStyle = '#000000';
                var Ax=j.toString();

                ctx.textAlign="end";

                ctx.fillText(Ax ,j*panelsize, 0.3*panelsize);



                if (hahaha[0][j]>0 || nonono[0][j]>0)  //如果整个被选中
                {
                   // console.log(i);
                    ctx.fillStyle =ctx.strokeStyle = 'rgba(55,55,55,0.5)';

                    ctx.fillRect((j-1) * panelsize+0.4*panelsize,0,panelsize, 0.4*panelsize);
                    
                }
                ctx.closePath();

            }

            //---------------------------画面板
            ctx.save();
            ctx.translate(panelsize*0.4,panelsize*0.4);
            for (var i = 0; i < hang; i++)
            {
                for (var j = 0; j < lie; j++)
                {
                    //ctx.fillStyle =ctx.strokeStyle = 'rgb(0,' + Math.floor(255 - 255/lie * j) + ',' + Math.floor(255 - 255/hang * i) + ')';
                    ctx.fillStyle =ctx.strokeStyle ="black";

                    ctx.beginPath();
                    ctx.lineWidth=2;
                    ctx.strokeRect(j * panelsize, i * panelsize, panelsize, panelsize);  //画框框
                    //出点点
                    // ctx.font ='1px 微软雅黑 bold';
                    // ctx.fillStyle = '#000000';
                    // var Ax=String.fromCharCode(64+i+1)+(j+1).toString();
                    //
                    // ctx.textAlign="end";
                    //
                    // ctx.fillText(Ax ,j * panelsize+panelsize-1, i * panelsize+panelsize-2);



                    // ctx.arc(panelsize / 2 + j * panelsize  , panelsize / 2 + i * panelsize , panelsize * 0.4, 0, Math.PI * 2,true); //画圈圈
                    // ctx.stroke();
                    ctx.closePath();

                    // if (hahaha[i][j] != 0)
                    //     //ctx.fillRect(i * panelsize, j * panelsize, panelsize, panelsize);
                    //     ctx.fill();
                    // else


                    ctx.beginPath();
                    ctx.fillStyle =ctx.strokeStyle = 'rgba(0,' + Math.floor(255 - 255/lie * j) + ',' +
                        Math.floor(255 - 255/hang * i) + ',0.5)';
                    if(nonono[i+1][j+1]>0)  //选择过程中的标识
                        ctx.fillRect(j * panelsize, i * panelsize, panelsize, panelsize);
                    if(hahaha[i+1][j+1]>0)  //被选中
                        ctx.fillRect(j * panelsize, i * panelsize, panelsize, panelsize);
                    if(cococo[i+1][j+1]==0) {

                        ctx.fillStyle = "#000000";

                        ctx.fillRect(j * panelsize+0.15* panelsize, i * panelsize+0.15* panelsize, panelsize-0.3* panelsize, panelsize-0.3* panelsize);

                        // ctx.arc(panelsize / 2 + j * panelsize, panelsize / 2 + i * panelsize, panelsize * 0.38, 0, Math.PI * 2, true); //画圈圈
                        // ctx.fill();
                    }
                    if(cococo[i+1][j+1]==1) {

                        ctx.fillStyle = "#4caf50";
                        ctx.arc(panelsize / 2 + j * panelsize, panelsize / 2 + i * panelsize, panelsize * 0.38, 0, Math.PI * 2, true); //画圈圈
                        ctx.fill();
                    }
                    if(cococo[i+1][j+1]==2) {

                        ctx.fillStyle = "#008cba";
                        ctx.arc(panelsize / 2 + j * panelsize, panelsize / 2 + i * panelsize, panelsize * 0.38, 0, Math.PI * 2, true); //画圈圈
                        ctx.fill();
                    }
                    if(cococo[i+1][j+1]==3) {

                        ctx.fillStyle = "#b80af4";
                        ctx.arc(panelsize / 2 + j * panelsize, panelsize / 2 + i * panelsize, panelsize * 0.38, 0, Math.PI * 2, true); //画圈圈
                        ctx.fill();
                    }
                    if(cococo[i+1][j+1]==4) {

                        ctx.strokeStyle = "#ff1d2d";
                        ctx.moveTo(j * panelsize,i * panelsize);
                        ctx.lineTo(j * panelsize+ panelsize,i* panelsize+panelsize);
                        ctx.moveTo(j * panelsize,i* panelsize+panelsize);
                        ctx.lineTo(j * panelsize+panelsize,i* panelsize);
                        ctx.stroke();

                       // ctx.arc(panelsize / 2 + j * panelsize, panelsize / 2 + i * panelsize, panelsize * 0.38, 0, Math.PI * 2, true); //画圈圈


                        //ctx.fill();
                    }
                    if(cococo[i+1][j+1]==6) {

                        ctx.fillStyle = 'rgba(55,55,55,0.5)';

                        ctx.fillRect(j * panelsize, i * panelsize, panelsize, panelsize);

                        // ctx.arc(panelsize / 2 + j * panelsize, panelsize / 2 + i * panelsize, panelsize * 0.38, 0, Math.PI * 2, true); //画圈圈
                        // ctx.fill();
                    }

                    ctx.closePath();


                }


                ctx.closePath();

            }

            ctx.restore();







        }


        //--------------------这个函数在于不去绘制任何图形只是操作数据结构而已
        function initcanvaspanel()
        {  //画圈圈和框框

            var oncanvas = document.getElementById('bbb');
            var ctx = oncanvas.getContext('2d');

            ctx.clearRect(0,0,800,600);

            oncanvas.onmouseover = function (ev)
            {  //鼠标进入区域
                console.log("onmouseoverbbb");
            };

            oncanvas.onmouseout =function ()
            {//鼠标移动出区域
                console.log("onmouseoutbbb");
                oncanvas.onmousemove=null;
                // document.onmouseup =null;
            };


            oncanvas.onmousedown=function (ev)  //鼠标按下去
            {
                console.log("onmousedown");
                //鼠标点下去
                //鼠标所在的位置
                //ev.offsetX
                //ev.offsetY
                var oldX = ev.offsetX-0.4*panelsize;
                var oldY = ev.offsetY-0.4*panelsize;
                var balldownX1 = Math.floor(oldX / panelsize);
                var balldownY1 = Math.floor(oldY / panelsize);

                console.log(balldownX1);
                console.log(balldownY1);


                nonono[balldownY1+1][balldownX1+1]=1;


                // hahaha=[];
                for (var a = 1; a <= hang; a++)
                {
                    if (nonono[a][0]>0)  //如果整个行被选中
                    {
                        //console.log("test");
                        for(var b=1;b<=lie;b++)
                        {
                            nonono[a][b]=1;
                        }
                    }

                }
                for (var b = 1; b <= lie; b++)
                {
                    if (nonono[0][b]>0)  //如果整个行被选中
                    {
                        //console.log("test");
                        for(var a=1;a<=hang;a++)
                        {
                            nonono[a][b]=1;
                        }
                    }

                }






                oncanvas.onmousemove=function (ev)   //鼠标按下去后框选
                {
                    console.log("onmousemove");
                    var oldX = ev.offsetX-0.4*panelsize;
                    var oldY = ev.offsetY-0.4*panelsize;


                    //----------------------------------------------矩形框选 任意方向矩形
                    var ballmoveX2 = Math.floor(oldX / panelsize);
                    var ballmoveY2 = Math.floor(oldY / panelsize);



                    nonono[ballmoveY2+1][ballmoveX2+1]=1;
                    console.log(ballmoveY2);
                    console.log(ballmoveX2);



                    var x1=Math.min(balldownX1,ballmoveX2);
                    var x2=Math.max(balldownX1,ballmoveX2);
                    var y1=Math.min(balldownY1,ballmoveY2);
                    var y2=Math.max(balldownY1,ballmoveY2);


                    //-------------------标记数组清空-----------------
                    nonono=[
                        [0,0,0,0,0,0,0,0,0,0,0,0,0],
                        [0,0,0,0,0,0,0,0,0,0,0,0,0],
                        [0,0,0,0,0,0,0,0,0,0,0,0,0],
                        [0,0,0,0,0,0,0,0,0,0,0,0,0],
                        [0,0,0,0,0,0,0,0,0,0,0,0,0],
                        [0,0,0,0,0,0,0,0,0,0,0,0,0],
                        [0,0,0,0,0,0,0,0,0,0,0,0,0],
                        [0,0,0,0,0,0,0,0,0,0,0,0,0],
                        [0,0,0,0,0,0,0,0,0,0,0,0,0]
                    ];

                    //把选中的格子标记在nonono里面

                    for (i = x1; i <= x2; i++)
                        for (j = y1; j <= y2; j++)
                            nonono[j+1][i+1] = 1;


                    for (var a = 1; a <= hang; a++)
                    {
                        if (nonono[a][0]>0)  //如果整个行被选中
                        {
                            console.log("test");
                            for(var b=1;b<=lie;b++)
                            {
                                nonono[a][b]=1;
                            }
                        }

                    }
                    for (var b = 1; b <= lie; b++)
                    {
                        if (nonono[0][b]>0)  //如果整个行被选中
                        {
                            //console.log("test");
                            for(var a=1;a<=hang;a++)
                            {
                                nonono[a][b]=1;
                            }
                        }

                    }

                    refreshpanel();


                }



                oncanvas.onmouseup=function (ev) //松开 有点好玩
                {
                    console.log("onmouseup");
                    oncanvas.onmousemove=null;
                    oncanvas.onmouseup =null;



                    var oldX = ev.offsetX;
                    var oldY = ev.offsetY;


                    //----------------------------------------------矩形框选 任意方向矩形

                    var ballupX2 = Math.floor(oldX / panelsize);
                    var ballupY2 = Math.floor(oldY / panelsize);


                    //如果点击同一个格子，则取消选择


                    // ----判断 如果点击和松开在同一个格子，则取消

                    // if (balldownX1==ballupX2 && balldownY1==ballupY2)
                    //
                    //     if(hahaha[balldownX1][balldownY1]==1)
                    //
                    //         nonono[balldownX1][balldownY1]=hahaha[balldownX1][balldownY1]=0;

                    //放开把nonono放入到hahaha中，并清空nonono
                    //如果按了control就添加 否则就以选中为准
                    if(ev.ctrlKey)
                    {
                        for (var i = 0; i < hang+1; i++) {
                            for (var j = 0; j < lie+1; j++) {
                                if(hahaha[i][j]+nonono[i][j]>=1)
                                    hahaha[i][j] = 1;
                                else
                                    hahaha[i][j]=0;
                                nonono[i][j] = 0;
                            }
                        }
                    }
                    else
                    {
                        for (var i = 0; i < hang+1; i++) {
                            for (var j = 0; j < lie+1; j++) {
                                //if(hahaha[i][j]+nonono[i][j]>=1)
                                hahaha[i][j] = nonono[i][j];
                                // else
                                //     hahaha[i][j]=0;
                                nonono[i][j] = 0;
                            }
                        }
                    }


                   // paneltoscatter();
                    selectpaneltoscatter();

                 //   refreshscatter();
                    refreshpanel();//改变hahaha[]后 重绘


                };


                refreshpanel();  //down函数按下去后重绘

            };


            refreshpanel();


        }




</script>














</body>
</html>